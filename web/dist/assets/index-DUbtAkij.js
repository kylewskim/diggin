import{r as x,a as kr,u as En,b as $s,R as Nn,c as Rr,N as Ks,B as jr,d as Ar,e as Nt}from"./vendor-CEroot8U.js";import{L as Lr,a as p,_ as Mr,C as Dr,r as ss,s as V,j as Sn,c as Ee,b as Xe,m as kt,d as Pr,S as Or,e as Fr,f as _t,g as Hr,h as Ur,D as Zs,q as Wr,i as Br,k as Gr,l as is,n as Ys,o as Vr,p as Qs,t as zr,u as Ht,v as qr,w as $r,x as Kr,y as Zr,z as Yr,A as Qr,B as Xr,E as Jr,F as eo,G as to,H as no,I as so,J as io,K as Xs,M as Ut,N as Ke,O as Js,P as yt,Q as Ie,R as Pe,T as Tn,U as Ct,V as ro,W as ei,X as oo,Z as lo,$ as ao}from"./firebase-Cb75WVKb.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();var ti={exports:{}},Wt={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var co=x,ho=Symbol.for("react.element"),uo=Symbol.for("react.fragment"),fo=Object.prototype.hasOwnProperty,po=co.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,go={key:!0,ref:!0,__self:!0,__source:!0};function ni(n,e,t){var s,i={},r=null,o=null;t!==void 0&&(r=""+t),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)fo.call(e,s)&&!go.hasOwnProperty(s)&&(i[s]=e[s]);if(n&&n.defaultProps)for(s in e=n.defaultProps,e)i[s]===void 0&&(i[s]=e[s]);return{$$typeof:ho,type:n,key:r,ref:o,props:i,_owner:po.current}}Wt.Fragment=uo;Wt.jsx=ni;Wt.jsxs=ni;ti.exports=Wt;var l=ti.exports,rn={},rs=kr;rn.createRoot=rs.createRoot,rn.hydrateRoot=rs.hydrateRoot;var os={};const ls="@firebase/database",as="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let si="";function mo(n){si=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),V(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Sn(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Ee(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ii=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new _o(e)}}catch{}return new yo},De=ii("localStorage"),Co=ii("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ze=new Lr("@firebase/database"),xo=function(){let n=1;return function(){return n++}}(),ri=function(n){const e=Pr(n),t=new Or;t.update(e);const s=t.digest();return Fr.encodeByteArray(s)},xt=function(...n){let e="";for(let t=0;t<n.length;t++){const s=n[t];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=xt.apply(null,s):typeof s=="object"?e+=V(s):e+=s,e+=" "}return e};let ht=null,cs=!0;const vo=function(n,e){p(!0,"Can't turn on custom loggers persistently."),Ze.logLevel=Ur.VERBOSE,ht=Ze.log.bind(Ze)},q=function(...n){if(cs===!0&&(cs=!1,ht===null&&Co.get("logging_enabled")===!0&&vo()),ht){const e=xt.apply(null,n);ht(e)}},vt=function(n){return function(...e){q(n,...e)}},on=function(...n){const e="FIREBASE INTERNAL ERROR: "+xt(...n);Ze.error(e)},be=function(...n){const e=`FIREBASE FATAL ERROR: ${xt(...n)}`;throw Ze.error(e),new Error(e)},J=function(...n){const e="FIREBASE WARNING: "+xt(...n);Ze.warn(e)},wo=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&J("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},oi=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},bo=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Je="[MIN_NAME]",Oe="[MAX_NAME]",tt=function(n,e){if(n===e)return 0;if(n===Je||e===Oe)return-1;if(e===Je||n===Oe)return 1;{const t=ds(n),s=ds(e);return t!==null?s!==null?t-s===0?n.length-e.length:t-s:-1:s!==null?1:n<e?-1:1}},Eo=function(n,e){return n===e?0:n<e?-1:1},rt=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+V(e))},In=function(n){if(typeof n!="object"||n===null)return V(n);const e=[];for(const s in n)e.push(s);e.sort();let t="{";for(let s=0;s<e.length;s++)s!==0&&(t+=","),t+=V(e[s]),t+=":",t+=In(n[e[s]]);return t+="}",t},li=function(n,e){const t=n.length;if(t<=e)return[n];const s=[];for(let i=0;i<t;i+=e)i+e>t?s.push(n.substring(i,t)):s.push(n.substring(i,i+e));return s};function se(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const ai=function(n){p(!oi(n),"Invalid JSON number");const e=11,t=52,s=(1<<e-1)-1;let i,r,o,a,c;n===0?(r=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-s)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),s),r=a+s,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(r=0,o=Math.round(n/Math.pow(2,1-s-t))));const d=[];for(c=t;c;c-=1)d.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)d.push(r%2?1:0),r=Math.floor(r/2);d.push(i?1:0),d.reverse();const h=d.join("");let u="";for(c=0;c<64;c+=8){let f=parseInt(h.substr(c,8),2).toString(16);f.length===1&&(f="0"+f),u=u+f}return u.toLowerCase()},No=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},So=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"},To=new RegExp("^-?(0*)\\d{1,10}$"),Io=-2147483648,ko=2147483647,ds=function(n){if(To.test(n)){const e=Number(n);if(e>=Io&&e<=ko)return e}return null},wt=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw J("Exception was thrown by user callback.",t),e},Math.floor(0))}},Ro=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},ut=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(s=>this.appCheck=s)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,s):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(s=>s.addTokenListener(e))}notifyForInvalidToken(){J(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(e,t,s){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(q("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,s):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',J(e)}}class It{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}It.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kn="5",ci="v",di="s",hi="r",ui="f",fi=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,pi="ls",gi="p",ln="ac",mi="websocket",_i="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e,t,s,i,r=!1,o="",a=!1,c=!1){this.secure=t,this.namespace=s,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=De.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&De.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function Lo(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function Ci(n,e,t){p(typeof e=="string","typeof type must == string"),p(typeof t=="object","typeof params must == object");let s;if(e===mi)s=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===_i)s=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Lo(n)&&(t.ns=n.namespace);const i=[];return se(t,(r,o)=>{i.push(r+"="+o)}),s+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(){this.counters_={}}incrementCounter(e,t=1){Ee(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return zr(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zt={},Yt={};function Rn(n){const e=n.toString();return Zt[e]||(Zt[e]=new Mo),Zt[e]}function Do(n,e){const t=n.toString();return Yt[t]||(Yt[t]=e()),Yt[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<s.length;++i)s[i]&&wt(()=>{this.onMessage_(s[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hs="start",Oo="close",Fo="pLPCommand",Ho="pRTLPCB",xi="id",vi="pw",wi="ser",Uo="cb",Wo="seg",Bo="ts",Go="d",Vo="dframe",bi=1870,Ei=30,zo=bi-Ei,qo=25e3,$o=3e4;class qe{constructor(e,t,s,i,r,o,a){this.connId=e,this.repoInfo=t,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=vt(e),this.stats_=Rn(t),this.urlFn=c=>(this.appCheckToken&&(c[ln]=this.appCheckToken),Ci(t,_i,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Po(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor($o)),bo(()=>{if(this.isClosed_)return;this.scriptTagHolder=new jn((...r)=>{const[o,a,c,d,h]=r;if(this.incrementIncomingBytes_(r),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===hs)this.id=a,this.password=c;else if(o===Oo)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...r)=>{const[o,a]=r;this.incrementIncomingBytes_(r),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const s={};s[hs]="t",s[wi]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[Uo]=this.scriptTagHolder.uniqueCallbackIdentifier),s[ci]=kn,this.transportSessionId&&(s[di]=this.transportSessionId),this.lastSessionId&&(s[pi]=this.lastSessionId),this.applicationId&&(s[gi]=this.applicationId),this.appCheckToken&&(s[ln]=this.appCheckToken),typeof location<"u"&&location.hostname&&fi.test(location.hostname)&&(s[hi]=ui);const i=this.urlFn(s);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){qe.forceAllow_=!0}static forceDisallow(){qe.forceDisallow_=!0}static isAvailable(){return qe.forceAllow_?!0:!qe.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!No()&&!So()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=V(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const s=qr(t),i=li(s,zo);for(let r=0;r<i.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[r]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const s={};s[Vo]="t",s[xi]=e,s[vi]=t,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=V(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class jn{constructor(e,t,s,i){this.onDisconnect=s,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=xo(),window[Fo+this.uniqueCallbackIdentifier]=e,window[Ho+this.uniqueCallbackIdentifier]=t,this.myIFrame=jn.createIFrame_();let r="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(r='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+r+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){q("frame writing exception"),a.stack&&q(a.stack),q(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||q("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[xi]=this.myID,e[vi]=this.myPW,e[wi]=this.currentSerial;let t=this.urlFn(e),s="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Ei+s.length<=bi;){const o=this.pendingSegs.shift();s=s+"&"+Wo+i+"="+o.seg+"&"+Bo+i+"="+o.ts+"&"+Go+i+"="+o.d,i++}return t=t+s,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,s){this.pendingSegs.push({seg:e,ts:t,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const s=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(s,Math.floor(qo)),r=()=>{clearTimeout(i),s()};this.addTag(e,r)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const i=s.readyState;(!i||i==="loaded"||i==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),t())},s.onerror=()=>{q("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ko=16384,Zo=45e3;let Rt=null;typeof MozWebSocket<"u"?Rt=MozWebSocket:typeof WebSocket<"u"&&(Rt=WebSocket);class ie{constructor(e,t,s,i,r,o,a){this.connId=e,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=vt(this.connId),this.stats_=Rn(t),this.connURL=ie.connectionURL_(t,o,a,i,s),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,s,i,r){const o={};return o[ci]=kn,typeof location<"u"&&location.hostname&&fi.test(location.hostname)&&(o[hi]=ui),t&&(o[di]=t),s&&(o[pi]=s),i&&(o[ln]=i),r&&(o[gi]=r),Ci(e,mi,o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,De.set("previous_websocket_failure",!0);try{let s;$r(),this.mySock=new Rt(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){ie.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(t);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&Rt!==null&&!ie.forceDisallow_}static previouslyFailed(){return De.isInMemoryStorage||De.get("previous_websocket_failure")===!0}markConnectionHealthy(){De.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const s=Sn(t);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(p(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const s=this.extractFrameCount_(t);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const t=V(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const s=li(t,Ko);s.length>1&&this.sendString_(String(s.length));for(let i=0;i<s.length;i++)this.sendString_(s[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Zo))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}ie.responsesRequiredToBeHealthy=2;ie.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[qe,ie]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=ie&&ie.isAvailable();let s=t&&!ie.previouslyFailed();if(e.webSocketOnly&&(t||J("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[ie];else{const i=this.transports_=[];for(const r of gt.ALL_TRANSPORTS)r&&r.isAvailable()&&i.push(r);gt.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}gt.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yo=6e4,Qo=5e3,Xo=10*1024,Jo=100*1024,Qt="t",us="d",el="s",fs="r",tl="e",ps="o",gs="a",ms="n",_s="p",nl="h";class sl{constructor(e,t,s,i,r,o,a,c,d,h){this.id=e,this.repoInfo_=t,this.applicationId_=s,this.appCheckToken_=i,this.authToken_=r,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=d,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=vt("c:"+this.id+":"),this.transportManager_=new gt(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,s)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=ut(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Jo?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Xo?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Qt in e){const t=e[Qt];t===gs?this.upgradeIfSecondaryHealthy_():t===fs?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===ps&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=rt("t",e),s=rt("d",e);if(t==="c")this.onSecondaryControl_(s);else if(t==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:_s,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:gs,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:ms,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=rt("t",e),s=rt("d",e);t==="c"?this.onControl_(s):t==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=rt(Qt,e);if(us in e){const s=e[us];if(t===nl){const i=Object.assign({},s);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===ms){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===el?this.onConnectionShutdown_(s):t===fs?this.onReset_(s):t===tl?on("Server Error: "+s):t===ps?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):on("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,s=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),kn!==s&&J("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,s),ut(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Yo))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ut(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Qo))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:_s,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(De.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{put(e,t,s,i){}merge(e,t,s,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,s){}onDisconnectMerge(e,t,s){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(e){this.allowedEvents_=e,this.listeners_={},p(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let i=0;i<s.length;i++)s[i].callback.apply(s[i].context,t)}}on(e,t,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:s});const i=this.getInitialEvent(e);i&&t.apply(s,i)}off(e,t,s){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let r=0;r<i.length;r++)if(i[r].callback===t&&(!s||s===i[r].context)){i.splice(r,1);return}}validateEventType_(e){p(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt extends Si{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Ys()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new jt}getInitialEvent(e){return p(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ys=32,Cs=768;class P{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let s=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[s]=this.pieces_[i],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function R(){return new P("")}function N(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function ke(n){return n.pieces_.length-n.pieceNum_}function D(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new P(n.pieces_,e)}function Ti(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function il(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function Ii(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function ki(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new P(e,0)}function B(n,e){const t=[];for(let s=n.pieceNum_;s<n.pieces_.length;s++)t.push(n.pieces_[s]);if(e instanceof P)for(let s=e.pieceNum_;s<e.pieces_.length;s++)t.push(e.pieces_[s]);else{const s=e.split("/");for(let i=0;i<s.length;i++)s[i].length>0&&t.push(s[i])}return new P(t,0)}function E(n){return n.pieceNum_>=n.pieces_.length}function ne(n,e){const t=N(n),s=N(e);if(t===null)return e;if(t===s)return ne(D(n),D(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function Ri(n,e){if(ke(n)!==ke(e))return!1;for(let t=n.pieceNum_,s=e.pieceNum_;t<=n.pieces_.length;t++,s++)if(n.pieces_[t]!==e.pieces_[s])return!1;return!0}function re(n,e){let t=n.pieceNum_,s=e.pieceNum_;if(ke(n)>ke(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[s])return!1;++t,++s}return!0}class rl{constructor(e,t){this.errorPrefix_=t,this.parts_=Ii(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=Ht(this.parts_[s]);ji(this)}}function ol(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Ht(e),ji(n)}function ll(n){const e=n.parts_.pop();n.byteLength_-=Ht(e),n.parts_.length>0&&(n.byteLength_-=1)}function ji(n){if(n.byteLength_>Cs)throw new Error(n.errorPrefix_+"has a key path longer than "+Cs+" bytes ("+n.byteLength_+").");if(n.parts_.length>ys)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+ys+") or object contains a cycle "+Me(n))}function Me(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An extends Si{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}static getInstance(){return new An}getInitialEvent(e){return p(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ot=1e3,al=60*5*1e3,xs=30*1e3,cl=1.3,dl=3e4,hl="server_kill",vs=3;class we extends Ni{constructor(e,t,s,i,r,o,a,c){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=s,this.onConnectStatus_=i,this.onServerInfoUpdate_=r,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=c,this.id=we.nextPersistentConnectionId_++,this.log_=vt("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ot,this.maxReconnectDelay_=al,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");An.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&jt.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,s){const i=++this.requestNumber_,r={r:i,a:e,b:t};this.log_(V(r)),p(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),s&&(this.requestCBHash_[i]=s)}get(e){this.initConnection_();const t=new Zs,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?t.resolve(a):t.reject(a)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}listen(e,t,s,i){this.initConnection_();const r=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+r),this.listens.has(o)||this.listens.set(o,new Map),p(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),p(!this.listens.get(o).has(r),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:t,query:e,tag:s};this.listens.get(o).set(r,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(s)})}sendListen_(e){const t=e.query,s=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+s+" for "+i);const r={p:s},o="q";e.tag&&(r.q=t._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest(o,r,a=>{const c=a.d,d=a.s;we.warnOnListenWarnings_(c,t),(this.listens.get(s)&&this.listens.get(s).get(i))===e&&(this.log_("listen response",a),d!=="ok"&&this.removeListen_(s,i),e.onComplete&&e.onComplete(d,c))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&Ee(e,"w")){const s=Xe(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const i='".indexOn": "'+t._queryParams.getIndex().toString()+'"',r=t._path.toString();J(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${r} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||Br(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=xs)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=Gr(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(t,s,i=>{const r=i.s,o=i.d||"error";this.authToken_===e&&(r==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(r,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,s=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,s)})}unlisten(e,t){const s=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+i),p(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,i)&&this.connected_&&this.sendUnlisten_(s,i,e._queryObject,t)}sendUnlisten_(e,t,s,i){this.log_("Unlisten on "+e+" for "+t);const r={p:e},o="n";i&&(r.q=s,r.t=i),this.sendRequest(o,r)}onDisconnectPut(e,t,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:s})}onDisconnectMerge(e,t,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:s})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,s,i){const r={p:t,d:s};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,t,s,i){this.putInternal("p",e,t,s,i)}merge(e,t,s,i){this.putInternal("m",e,t,s,i)}putInternal(e,t,s,i,r){this.initConnection_();const o={p:t,d:s};r!==void 0&&(o.h=r),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,s,r=>{this.log_(t+" response",r),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(r.s,r.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,s=>{if(s.s!=="ok"){const r=s.d;this.log_("reportStats","Error sending stats: "+r)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+V(e));const t=e.r,s=this.requestCBHash_[t];s&&(delete this.requestCBHash_[t],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):on("Unrecognized action received from server: "+V(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){p(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ot,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=ot,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>dl&&(this.reconnectDelay_=ot),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*cl)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+we.nextConnectionId_++,r=this.lastSessionId;let o=!1,a=null;const c=function(){a?a.close():(o=!0,s())},d=function(u){p(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(u)};this.realtime_={close:c,sendRequest:d};const h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[u,f]=await Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);o?q("getToken() completed but was canceled"):(q("getToken() completed. Creating connection."),this.authToken_=u&&u.accessToken,this.appCheckToken_=f&&f.token,a=new sl(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,s,m=>{J(m+" ("+this.repoInfo_.toString()+")"),this.interrupt(hl)},r))}catch(u){this.log_("Failed to get token: "+u),o||(this.repoInfo_.nodeAdmin&&J(u),c())}}}interrupt(e){q("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){q("Resuming connection for reason: "+e),delete this.interruptReasons_[e],is(this.interruptReasons_)&&(this.reconnectDelay_=ot,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let s;t?s=t.map(r=>In(r)).join("$"):s="default";const i=this.removeListen_(e,s);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const s=new P(e).toString();let i;if(this.listens.has(s)){const r=this.listens.get(s);i=r.get(t),r.delete(t),r.size===0&&this.listens.delete(s)}else i=void 0;return i}onAuthRevoked_(e,t){q("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=vs&&(this.reconnectDelay_=xs,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){q("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=vs&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+si.replace(/\./g,"-")]=1,Ys()?e["framework.cordova"]=1:Vr()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=jt.getInstance().currentlyOnline();return is(this.interruptReasons_)&&e}}we.nextPersistentConnectionId_=0;we.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new S(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const s=new S(Je,e),i=new S(Je,t);return this.compare(s,i)!==0}minPost(){return S.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let St;class Ai extends Bt{static get __EMPTY_NODE(){return St}static set __EMPTY_NODE(e){St=e}compare(e,t){return tt(e.name,t.name)}isDefinedOn(e){throw _t("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return S.MIN}maxPost(){return new S(Oe,St)}makePost(e,t){return p(typeof e=="string","KeyIndex indexValue must always be a string."),new S(e,St)}toString(){return".key"}}const Ye=new Ai;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e,t,s,i,r=null){this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?s(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class W{constructor(e,t,s,i,r){this.key=e,this.value=t,this.color=s??W.RED,this.left=i??Y.EMPTY_NODE,this.right=r??Y.EMPTY_NODE}copy(e,t,s,i,r){return new W(e??this.key,t??this.value,s??this.color,i??this.left,r??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let i=this;const r=s(e,i.key);return r<0?i=i.copy(null,null,null,i.left.insert(e,t,s),null):r===0?i=i.copy(null,t,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,t,s)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return Y.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let s,i;if(s=this,t(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),t(e,s.key)===0){if(s.right.isEmpty())return Y.EMPTY_NODE;i=s.right.min_(),s=s.copy(i.key,i.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,W.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,W.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}W.RED=!0;W.BLACK=!1;class ul{copy(e,t,s,i,r){return this}insert(e,t,s){return new W(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Y{constructor(e,t=Y.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Y(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,W.BLACK,null,null))}remove(e){return new Y(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,W.BLACK,null,null))}get(e){let t,s=this.root_;for(;!s.isEmpty();){if(t=this.comparator_(e,s.key),t===0)return s.value;t<0?s=s.left:t>0&&(s=s.right)}return null}getPredecessorKey(e){let t,s=this.root_,i=null;for(;!s.isEmpty();)if(t=this.comparator_(e,s.key),t===0){if(s.left.isEmpty())return i?i.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else t<0?s=s.left:t>0&&(i=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Tt(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Tt(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Tt(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Tt(this.root_,null,this.comparator_,!0,e)}}Y.EMPTY_NODE=new ul;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fl(n,e){return tt(n.name,e.name)}function Ln(n,e){return tt(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let an;function pl(n){an=n}const Li=function(n){return typeof n=="number"?"number:"+ai(n):"string:"+n},Mi=function(n){if(n.isLeafNode()){const e=n.val();p(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Ee(e,".sv"),"Priority must be a string or number.")}else p(n===an||n.isEmpty(),"priority of unexpected type.");p(n===an||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ws;class U{constructor(e,t=U.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,p(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Mi(this.priorityNode_)}static set __childrenNodeConstructor(e){ws=e}static get __childrenNodeConstructor(){return ws}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new U(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:U.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return E(e)?this:N(e)===".priority"?this.priorityNode_:U.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:U.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const s=N(e);return s===null?t:t.isEmpty()&&s!==".priority"?this:(p(s!==".priority"||ke(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,U.__childrenNodeConstructor.EMPTY_NODE.updateChild(D(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Li(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=ai(this.value_):e+=this.value_,this.lazyHash_=ri(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===U.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof U.__childrenNodeConstructor?-1:(p(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,s=typeof this.value_,i=U.VALUE_TYPE_ORDER.indexOf(t),r=U.VALUE_TYPE_ORDER.indexOf(s);return p(i>=0,"Unknown leaf type: "+t),p(r>=0,"Unknown leaf type: "+s),i===r?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}U.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Di,Pi;function gl(n){Di=n}function ml(n){Pi=n}class _l extends Bt{compare(e,t){const s=e.node.getPriority(),i=t.node.getPriority(),r=s.compareTo(i);return r===0?tt(e.name,t.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return S.MIN}maxPost(){return new S(Oe,new U("[PRIORITY-POST]",Pi))}makePost(e,t){const s=Di(e);return new S(t,new U("[PRIORITY-POST]",s))}toString(){return".priority"}}const K=new _l;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yl=Math.log(2);class Cl{constructor(e){const t=r=>parseInt(Math.log(r)/yl,10),s=r=>parseInt(Array(r+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const i=s(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const At=function(n,e,t,s){n.sort(e);const i=function(c,d){const h=d-c;let u,f;if(h===0)return null;if(h===1)return u=n[c],f=t?t(u):u,new W(f,u.node,W.BLACK,null,null);{const m=parseInt(h/2,10)+c,_=i(c,m),v=i(m+1,d);return u=n[m],f=t?t(u):u,new W(f,u.node,W.BLACK,_,v)}},r=function(c){let d=null,h=null,u=n.length;const f=function(_,v){const C=u-_,k=u;u-=_;const F=i(C+1,k),Q=n[C],z=t?t(Q):Q;m(new W(z,Q.node,v,null,F))},m=function(_){d?(d.left=_,d=_):(h=_,d=_)};for(let _=0;_<c.count;++_){const v=c.nextBitIsOne(),C=Math.pow(2,c.count-(_+1));v?f(C,W.BLACK):(f(C,W.BLACK),f(C,W.RED))}return h},o=new Cl(n.length),a=r(o);return new Y(s||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xt;const ze={};class ve{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return p(ze&&K,"ChildrenNode.ts has not been loaded"),Xt=Xt||new ve({".priority":ze},{".priority":K}),Xt}get(e){const t=Xe(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Y?t:null}hasIndex(e){return Ee(this.indexSet_,e.toString())}addIndex(e,t){p(e!==Ye,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let i=!1;const r=t.getIterator(S.Wrap);let o=r.getNext();for(;o;)i=i||e.isDefinedOn(o.node),s.push(o),o=r.getNext();let a;i?a=At(s,e.getCompare()):a=ze;const c=e.toString(),d=Object.assign({},this.indexSet_);d[c]=e;const h=Object.assign({},this.indexes_);return h[c]=a,new ve(h,d)}addToIndexes(e,t){const s=kt(this.indexes_,(i,r)=>{const o=Xe(this.indexSet_,r);if(p(o,"Missing index implementation for "+r),i===ze)if(o.isDefinedOn(e.node)){const a=[],c=t.getIterator(S.Wrap);let d=c.getNext();for(;d;)d.name!==e.name&&a.push(d),d=c.getNext();return a.push(e),At(a,o.getCompare())}else return ze;else{const a=t.get(e.name);let c=i;return a&&(c=c.remove(new S(e.name,a))),c.insert(e,e.node)}});return new ve(s,this.indexSet_)}removeFromIndexes(e,t){const s=kt(this.indexes_,i=>{if(i===ze)return i;{const r=t.get(e.name);return r?i.remove(new S(e.name,r)):i}});return new ve(s,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lt;class I{constructor(e,t,s){this.children_=e,this.priorityNode_=t,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&Mi(this.priorityNode_),this.children_.isEmpty()&&p(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return lt||(lt=new I(new Y(Ln),null,ve.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||lt}updatePriority(e){return this.children_.isEmpty()?this:new I(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?lt:t}}getChild(e){const t=N(e);return t===null?this:this.getImmediateChild(t).getChild(D(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(p(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const s=new S(e,t);let i,r;t.isEmpty()?(i=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(s,this.children_)):(i=this.children_.insert(e,t),r=this.indexMap_.addToIndexes(s,this.children_));const o=i.isEmpty()?lt:this.priorityNode_;return new I(i,o,r)}}updateChild(e,t){const s=N(e);if(s===null)return t;{p(N(e)!==".priority"||ke(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(s).updateChild(D(e),t);return this.updateImmediateChild(s,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let s=0,i=0,r=!0;if(this.forEachChild(K,(o,a)=>{t[o]=a.val(e),s++,r&&I.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):r=!1}),!e&&r&&i<2*s){const o=[];for(const a in t)o[a]=t[a];return o}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+Li(this.getPriority().val())+":"),this.forEachChild(K,(t,s)=>{const i=s.hash();i!==""&&(e+=":"+t+":"+i)}),this.lazyHash_=e===""?"":ri(e)}return this.lazyHash_}getPredecessorChildName(e,t,s){const i=this.resolveIndex_(s);if(i){const r=i.getPredecessorKey(new S(e,t));return r?r.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const s=t.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new S(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const s=t.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new S(t,this.children_.get(t)):null}forEachChild(e,t){const s=this.resolveIndex_(e);return s?s.inorderTraversal(i=>t(i.name,i.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const s=this.resolveIndex_(t);if(s)return s.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,S.Wrap);let r=i.peek();for(;r!=null&&t.compare(r,e)<0;)i.getNext(),r=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const s=this.resolveIndex_(t);if(s)return s.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,S.Wrap);let r=i.peek();for(;r!=null&&t.compare(r,e)>0;)i.getNext(),r=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===bt?-1:0}withIndex(e){if(e===Ye||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new I(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Ye||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const s=this.getIterator(K),i=t.getIterator(K);let r=s.getNext(),o=i.getNext();for(;r&&o;){if(r.name!==o.name||!r.node.equals(o.node))return!1;r=s.getNext(),o=i.getNext()}return r===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Ye?null:this.indexMap_.get(e.toString())}}I.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class xl extends I{constructor(){super(new Y(Ln),I.EMPTY_NODE,ve.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return I.EMPTY_NODE}isEmpty(){return!1}}const bt=new xl;Object.defineProperties(S,{MIN:{value:new S(Je,I.EMPTY_NODE)},MAX:{value:new S(Oe,bt)}});Ai.__EMPTY_NODE=I.EMPTY_NODE;U.__childrenNodeConstructor=I;pl(bt);ml(bt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vl=!0;function $(n,e=null){if(n===null)return I.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),p(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new U(t,$(e))}if(!(n instanceof Array)&&vl){const t=[];let s=!1;if(se(n,(o,a)=>{if(o.substring(0,1)!=="."){const c=$(a);c.isEmpty()||(s=s||!c.getPriority().isEmpty(),t.push(new S(o,c)))}}),t.length===0)return I.EMPTY_NODE;const r=At(t,fl,o=>o.name,Ln);if(s){const o=At(t,K.getCompare());return new I(r,$(e),new ve({".priority":o},{".priority":K}))}else return new I(r,$(e),ve.Default)}else{let t=I.EMPTY_NODE;return se(n,(s,i)=>{if(Ee(n,s)&&s.substring(0,1)!=="."){const r=$(i);(r.isLeafNode()||!r.isEmpty())&&(t=t.updateImmediateChild(s,r))}}),t.updatePriority($(e))}}gl($);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl extends Bt{constructor(e){super(),this.indexPath_=e,p(!E(e)&&N(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const s=this.extractChild(e.node),i=this.extractChild(t.node),r=s.compareTo(i);return r===0?tt(e.name,t.name):r}makePost(e,t){const s=$(e),i=I.EMPTY_NODE.updateChild(this.indexPath_,s);return new S(t,i)}maxPost(){const e=I.EMPTY_NODE.updateChild(this.indexPath_,bt);return new S(Oe,e)}toString(){return Ii(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl extends Bt{compare(e,t){const s=e.node.compareTo(t.node);return s===0?tt(e.name,t.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return S.MIN}maxPost(){return S.MAX}makePost(e,t){const s=$(e);return new S(t,s)}toString(){return".value"}}const El=new bl;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nl(n){return{type:"value",snapshotNode:n}}function Sl(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Tl(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function bs(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function Il(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=K}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return p(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return p(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Je}hasEnd(){return this.endSet_}getIndexEndValue(){return p(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return p(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Oe}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return p(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===K}copy(){const e=new Mn;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Es(n){const e={};if(n.isDefault())return e;let t;if(n.index_===K?t="$priority":n.index_===El?t="$value":n.index_===Ye?t="$key":(p(n.index_ instanceof wl,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=V(t),n.startSet_){const s=n.startAfterSet_?"startAfter":"startAt";e[s]=V(n.indexStartValue_),n.startNameSet_&&(e[s]+=","+V(n.indexStartName_))}if(n.endSet_){const s=n.endBeforeSet_?"endBefore":"endAt";e[s]=V(n.indexEndValue_),n.endNameSet_&&(e[s]+=","+V(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function Ns(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==K&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt extends Ni{constructor(e,t,s,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=s,this.appCheckTokenProvider_=i,this.log_=vt("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(p(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,s,i){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const o=Lt.getListenId_(e,s),a={};this.listens_[o]=a;const c=Es(e._queryParams);this.restRequest_(r+".json",c,(d,h)=>{let u=h;if(d===404&&(u=null,d=null),d===null&&this.onDataUpdate_(r,u,!1,s),Xe(this.listens_,o)===a){let f;d?d===401?f="permission_denied":f="rest_error:"+d:f="ok",i(f,null)}})}unlisten(e,t){const s=Lt.getListenId_(e,t);delete this.listens_[s]}get(e){const t=Es(e._queryParams),s=e._path.toString(),i=new Zs;return this.restRequest_(s+".json",t,(r,o)=>{let a=o;r===404&&(a=null,r=null),r===null?(this.onDataUpdate_(s,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},s){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,r])=>{i&&i.accessToken&&(t.auth=i.accessToken),r&&r.token&&(t.ac=r.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Wr(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(s&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=Sn(a.responseText)}catch{J("Failed to parse JSON response for "+o+": "+a.responseText)}s(null,c)}else a.status!==401&&a.status!==404&&J("Got unsuccessful REST response for "+o+" Status: "+a.status),s(a.status);s=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(){this.rootNode_=I.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mt(){return{value:null,children:new Map}}function Oi(n,e,t){if(E(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const s=N(e);n.children.has(s)||n.children.set(s,Mt());const i=n.children.get(s);e=D(e),Oi(i,e,t)}}function cn(n,e,t){n.value!==null?t(e,n.value):Rl(n,(s,i)=>{const r=new P(e.toString()+"/"+s);cn(i,r,t)})}function Rl(n,e){n.children.forEach((t,s)=>{e(s,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jl{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&se(this.last_,(s,i)=>{t[s]=t[s]-i}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ss=10*1e3,Al=30*1e3,Ll=5*60*1e3;class Ml{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new jl(e);const s=Ss+(Al-Ss)*Math.random();ut(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),t={};let s=!1;se(e,(i,r)=>{r>0&&Ee(this.statsToReport_,i)&&(t[i]=r,s=!0)}),s&&this.server_.reportStats(t),ut(this.reportStats_.bind(this),Math.floor(Math.random()*2*Ll))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pe;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(pe||(pe={}));function Fi(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Hi(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Ui(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e,t,s){this.path=e,this.affectedTree=t,this.revert=s,this.type=pe.ACK_USER_WRITE,this.source=Fi()}operationForChild(e){if(E(this.path)){if(this.affectedTree.value!=null)return p(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new P(e));return new Dt(R(),t,this.revert)}}else return p(N(this.path)===e,"operationForChild called for unrelated child."),new Dt(D(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e,t,s){this.source=e,this.path=t,this.snap=s,this.type=pe.OVERWRITE}operationForChild(e){return E(this.path)?new Fe(this.source,R(),this.snap.getImmediateChild(e)):new Fe(this.source,D(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e,t,s){this.source=e,this.path=t,this.children=s,this.type=pe.MERGE}operationForChild(e){if(E(this.path)){const t=this.children.subtree(new P(e));return t.isEmpty()?null:t.value?new Fe(this.source,R(),t.value):new mt(this.source,R(),t)}else return p(N(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new mt(this.source,D(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e,t,s){this.node_=e,this.fullyInitialized_=t,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(E(e))return this.isFullyInitialized()&&!this.filtered_;const t=N(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}function Dl(n,e,t,s){const i=[],r=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&r.push(Il(o.childName,o.snapshotNode))}),at(n,i,"child_removed",e,s,t),at(n,i,"child_added",e,s,t),at(n,i,"child_moved",r,s,t),at(n,i,"child_changed",e,s,t),at(n,i,"value",e,s,t),i}function at(n,e,t,s,i,r){const o=s.filter(a=>a.type===t);o.sort((a,c)=>Ol(n,a,c)),o.forEach(a=>{const c=Pl(n,a,r);i.forEach(d=>{d.respondsTo(a.type)&&e.push(d.createEvent(c,n.query_))})})}function Pl(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function Ol(n,e,t){if(e.childName==null||t.childName==null)throw _t("Should only compare child_ events.");const s=new S(e.childName,e.snapshotNode),i=new S(t.childName,t.snapshotNode);return n.index_.compare(s,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wi(n,e){return{eventCache:n,serverCache:e}}function ft(n,e,t,s){return Wi(new Dn(e,t,s),n.serverCache)}function Bi(n,e,t,s){return Wi(n.eventCache,new Dn(e,t,s))}function dn(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function He(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jt;const Fl=()=>(Jt||(Jt=new Y(Eo)),Jt);class M{constructor(e,t=Fl()){this.value=e,this.children=t}static fromObject(e){let t=new M(null);return se(e,(s,i)=>{t=t.set(new P(s),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:R(),value:this.value};if(E(e))return null;{const s=N(e),i=this.children.get(s);if(i!==null){const r=i.findRootMostMatchingPathAndValue(D(e),t);return r!=null?{path:B(new P(s),r.path),value:r.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(E(e))return this;{const t=N(e),s=this.children.get(t);return s!==null?s.subtree(D(e)):new M(null)}}set(e,t){if(E(e))return new M(t,this.children);{const s=N(e),r=(this.children.get(s)||new M(null)).set(D(e),t),o=this.children.insert(s,r);return new M(this.value,o)}}remove(e){if(E(e))return this.children.isEmpty()?new M(null):new M(null,this.children);{const t=N(e),s=this.children.get(t);if(s){const i=s.remove(D(e));let r;return i.isEmpty()?r=this.children.remove(t):r=this.children.insert(t,i),this.value===null&&r.isEmpty()?new M(null):new M(this.value,r)}else return this}}get(e){if(E(e))return this.value;{const t=N(e),s=this.children.get(t);return s?s.get(D(e)):null}}setTree(e,t){if(E(e))return t;{const s=N(e),r=(this.children.get(s)||new M(null)).setTree(D(e),t);let o;return r.isEmpty()?o=this.children.remove(s):o=this.children.insert(s,r),new M(this.value,o)}}fold(e){return this.fold_(R(),e)}fold_(e,t){const s={};return this.children.inorderTraversal((i,r)=>{s[i]=r.fold_(B(e,i),t)}),t(e,this.value,s)}findOnPath(e,t){return this.findOnPath_(e,R(),t)}findOnPath_(e,t,s){const i=this.value?s(t,this.value):!1;if(i)return i;if(E(e))return null;{const r=N(e),o=this.children.get(r);return o?o.findOnPath_(D(e),B(t,r),s):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,R(),t)}foreachOnPath_(e,t,s){if(E(e))return this;{this.value&&s(t,this.value);const i=N(e),r=this.children.get(i);return r?r.foreachOnPath_(D(e),B(t,i),s):new M(null)}}foreach(e){this.foreach_(R(),e)}foreach_(e,t){this.children.inorderTraversal((s,i)=>{i.foreach_(B(e,s),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,s)=>{s.value&&e(t,s.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(e){this.writeTree_=e}static empty(){return new oe(new M(null))}}function pt(n,e,t){if(E(e))return new oe(new M(t));{const s=n.writeTree_.findRootMostValueAndPath(e);if(s!=null){const i=s.path;let r=s.value;const o=ne(i,e);return r=r.updateChild(o,t),new oe(n.writeTree_.set(i,r))}else{const i=new M(t),r=n.writeTree_.setTree(e,i);return new oe(r)}}}function Ts(n,e,t){let s=n;return se(t,(i,r)=>{s=pt(s,B(e,i),r)}),s}function Is(n,e){if(E(e))return oe.empty();{const t=n.writeTree_.setTree(e,new M(null));return new oe(t)}}function hn(n,e){return Ue(n,e)!=null}function Ue(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(ne(t.path,e)):null}function ks(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(K,(s,i)=>{e.push(new S(s,i))}):n.writeTree_.children.inorderTraversal((s,i)=>{i.value!=null&&e.push(new S(s,i.value))}),e}function Te(n,e){if(E(e))return n;{const t=Ue(n,e);return t!=null?new oe(new M(t)):new oe(n.writeTree_.subtree(e))}}function un(n){return n.writeTree_.isEmpty()}function et(n,e){return Gi(R(),n.writeTree_,e)}function Gi(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let s=null;return e.children.inorderTraversal((i,r)=>{i===".priority"?(p(r.value!==null,"Priority writes must always be leaf nodes"),s=r.value):t=Gi(B(n,i),r,t)}),!t.getChild(n).isEmpty()&&s!==null&&(t=t.updateChild(B(n,".priority"),s)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vi(n,e){return Zi(e,n)}function Hl(n,e,t,s,i){p(s>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:s,visible:i}),i&&(n.visibleWrites=pt(n.visibleWrites,e,t)),n.lastWriteId=s}function Ul(n,e){for(let t=0;t<n.allWrites.length;t++){const s=n.allWrites[t];if(s.writeId===e)return s}return null}function Wl(n,e){const t=n.allWrites.findIndex(a=>a.writeId===e);p(t>=0,"removeWrite called with nonexistent writeId.");const s=n.allWrites[t];n.allWrites.splice(t,1);let i=s.visible,r=!1,o=n.allWrites.length-1;for(;i&&o>=0;){const a=n.allWrites[o];a.visible&&(o>=t&&Bl(a,s.path)?i=!1:re(s.path,a.path)&&(r=!0)),o--}if(i){if(r)return Gl(n),!0;if(s.snap)n.visibleWrites=Is(n.visibleWrites,s.path);else{const a=s.children;se(a,c=>{n.visibleWrites=Is(n.visibleWrites,B(s.path,c))})}return!0}else return!1}function Bl(n,e){if(n.snap)return re(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&re(B(n.path,t),e))return!0;return!1}function Gl(n){n.visibleWrites=zi(n.allWrites,Vl,R()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function Vl(n){return n.visible}function zi(n,e,t){let s=oe.empty();for(let i=0;i<n.length;++i){const r=n[i];if(e(r)){const o=r.path;let a;if(r.snap)re(t,o)?(a=ne(t,o),s=pt(s,a,r.snap)):re(o,t)&&(a=ne(o,t),s=pt(s,R(),r.snap.getChild(a)));else if(r.children){if(re(t,o))a=ne(t,o),s=Ts(s,a,r.children);else if(re(o,t))if(a=ne(o,t),E(a))s=Ts(s,R(),r.children);else{const c=Xe(r.children,N(a));if(c){const d=c.getChild(D(a));s=pt(s,R(),d)}}}else throw _t("WriteRecord should have .snap or .children")}}return s}function qi(n,e,t,s,i){if(!s&&!i){const r=Ue(n.visibleWrites,e);if(r!=null)return r;{const o=Te(n.visibleWrites,e);if(un(o))return t;if(t==null&&!hn(o,R()))return null;{const a=t||I.EMPTY_NODE;return et(o,a)}}}else{const r=Te(n.visibleWrites,e);if(!i&&un(r))return t;if(!i&&t==null&&!hn(r,R()))return null;{const o=function(d){return(d.visible||i)&&(!s||!~s.indexOf(d.writeId))&&(re(d.path,e)||re(e,d.path))},a=zi(n.allWrites,o,e),c=t||I.EMPTY_NODE;return et(a,c)}}}function zl(n,e,t){let s=I.EMPTY_NODE;const i=Ue(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(K,(r,o)=>{s=s.updateImmediateChild(r,o)}),s;if(t){const r=Te(n.visibleWrites,e);return t.forEachChild(K,(o,a)=>{const c=et(Te(r,new P(o)),a);s=s.updateImmediateChild(o,c)}),ks(r).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}else{const r=Te(n.visibleWrites,e);return ks(r).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}}function ql(n,e,t,s,i){p(s||i,"Either existingEventSnap or existingServerSnap must exist");const r=B(e,t);if(hn(n.visibleWrites,r))return null;{const o=Te(n.visibleWrites,r);return un(o)?i.getChild(t):et(o,i.getChild(t))}}function $l(n,e,t,s){const i=B(e,t),r=Ue(n.visibleWrites,i);if(r!=null)return r;if(s.isCompleteForChild(t)){const o=Te(n.visibleWrites,i);return et(o,s.getNode().getImmediateChild(t))}else return null}function Kl(n,e){return Ue(n.visibleWrites,e)}function Zl(n,e,t,s,i,r,o){let a;const c=Te(n.visibleWrites,e),d=Ue(c,R());if(d!=null)a=d;else if(t!=null)a=et(c,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const h=[],u=o.getCompare(),f=r?a.getReverseIteratorFrom(s,o):a.getIteratorFrom(s,o);let m=f.getNext();for(;m&&h.length<i;)u(m,s)!==0&&h.push(m),m=f.getNext();return h}else return[]}function Yl(){return{visibleWrites:oe.empty(),allWrites:[],lastWriteId:-1}}function fn(n,e,t,s){return qi(n.writeTree,n.treePath,e,t,s)}function $i(n,e){return zl(n.writeTree,n.treePath,e)}function Rs(n,e,t,s){return ql(n.writeTree,n.treePath,e,t,s)}function Pt(n,e){return Kl(n.writeTree,B(n.treePath,e))}function Ql(n,e,t,s,i,r){return Zl(n.writeTree,n.treePath,e,t,s,i,r)}function Pn(n,e,t){return $l(n.writeTree,n.treePath,e,t)}function Ki(n,e){return Zi(B(n.treePath,e),n.writeTree)}function Zi(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,s=e.childName;p(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),p(s!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(s);if(i){const r=i.type;if(t==="child_added"&&r==="child_removed")this.changeMap.set(s,bs(s,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&r==="child_added")this.changeMap.delete(s);else if(t==="child_removed"&&r==="child_changed")this.changeMap.set(s,Tl(s,i.oldSnap));else if(t==="child_changed"&&r==="child_added")this.changeMap.set(s,Sl(s,e.snapshotNode));else if(t==="child_changed"&&r==="child_changed")this.changeMap.set(s,bs(s,e.snapshotNode,i.oldSnap));else throw _t("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{getCompleteChild(e){return null}getChildAfterChild(e,t,s){return null}}const Yi=new Jl;class On{constructor(e,t,s=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=s}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new Dn(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Pn(this.writes_,e,s)}}getChildAfterChild(e,t,s){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:He(this.viewCache_),r=Ql(this.writes_,i,t,1,s,e);return r.length===0?null:r[0]}}function ea(n,e){p(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),p(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function ta(n,e,t,s,i){const r=new Xl;let o,a;if(t.type===pe.OVERWRITE){const d=t;d.source.fromUser?o=pn(n,e,d.path,d.snap,s,i,r):(p(d.source.fromServer,"Unknown source."),a=d.source.tagged||e.serverCache.isFiltered()&&!E(d.path),o=Ot(n,e,d.path,d.snap,s,i,a,r))}else if(t.type===pe.MERGE){const d=t;d.source.fromUser?o=sa(n,e,d.path,d.children,s,i,r):(p(d.source.fromServer,"Unknown source."),a=d.source.tagged||e.serverCache.isFiltered(),o=gn(n,e,d.path,d.children,s,i,a,r))}else if(t.type===pe.ACK_USER_WRITE){const d=t;d.revert?o=oa(n,e,d.path,s,i,r):o=ia(n,e,d.path,d.affectedTree,s,i,r)}else if(t.type===pe.LISTEN_COMPLETE)o=ra(n,e,t.path,s,r);else throw _t("Unknown operation type: "+t.type);const c=r.getChanges();return na(e,o,c),{viewCache:o,changes:c}}function na(n,e,t){const s=e.eventCache;if(s.isFullyInitialized()){const i=s.getNode().isLeafNode()||s.getNode().isEmpty(),r=dn(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!s.getNode().equals(r)||!s.getNode().getPriority().equals(r.getPriority()))&&t.push(Nl(dn(e)))}}function Qi(n,e,t,s,i,r){const o=e.eventCache;if(Pt(s,t)!=null)return e;{let a,c;if(E(t))if(p(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const d=He(e),h=d instanceof I?d:I.EMPTY_NODE,u=$i(s,h);a=n.filter.updateFullNode(e.eventCache.getNode(),u,r)}else{const d=fn(s,He(e));a=n.filter.updateFullNode(e.eventCache.getNode(),d,r)}else{const d=N(t);if(d===".priority"){p(ke(t)===1,"Can't have a priority with additional path components");const h=o.getNode();c=e.serverCache.getNode();const u=Rs(s,t,h,c);u!=null?a=n.filter.updatePriority(h,u):a=o.getNode()}else{const h=D(t);let u;if(o.isCompleteForChild(d)){c=e.serverCache.getNode();const f=Rs(s,t,o.getNode(),c);f!=null?u=o.getNode().getImmediateChild(d).updateChild(h,f):u=o.getNode().getImmediateChild(d)}else u=Pn(s,d,e.serverCache);u!=null?a=n.filter.updateChild(o.getNode(),d,u,h,i,r):a=o.getNode()}}return ft(e,a,o.isFullyInitialized()||E(t),n.filter.filtersNodes())}}function Ot(n,e,t,s,i,r,o,a){const c=e.serverCache;let d;const h=o?n.filter:n.filter.getIndexedFilter();if(E(t))d=h.updateFullNode(c.getNode(),s,null);else if(h.filtersNodes()&&!c.isFiltered()){const m=c.getNode().updateChild(t,s);d=h.updateFullNode(c.getNode(),m,null)}else{const m=N(t);if(!c.isCompleteForPath(t)&&ke(t)>1)return e;const _=D(t),C=c.getNode().getImmediateChild(m).updateChild(_,s);m===".priority"?d=h.updatePriority(c.getNode(),C):d=h.updateChild(c.getNode(),m,C,_,Yi,null)}const u=Bi(e,d,c.isFullyInitialized()||E(t),h.filtersNodes()),f=new On(i,u,r);return Qi(n,u,t,i,f,a)}function pn(n,e,t,s,i,r,o){const a=e.eventCache;let c,d;const h=new On(i,e,r);if(E(t))d=n.filter.updateFullNode(e.eventCache.getNode(),s,o),c=ft(e,d,!0,n.filter.filtersNodes());else{const u=N(t);if(u===".priority")d=n.filter.updatePriority(e.eventCache.getNode(),s),c=ft(e,d,a.isFullyInitialized(),a.isFiltered());else{const f=D(t),m=a.getNode().getImmediateChild(u);let _;if(E(f))_=s;else{const v=h.getCompleteChild(u);v!=null?Ti(f)===".priority"&&v.getChild(ki(f)).isEmpty()?_=v:_=v.updateChild(f,s):_=I.EMPTY_NODE}if(m.equals(_))c=e;else{const v=n.filter.updateChild(a.getNode(),u,_,f,h,o);c=ft(e,v,a.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function js(n,e){return n.eventCache.isCompleteForChild(e)}function sa(n,e,t,s,i,r,o){let a=e;return s.foreach((c,d)=>{const h=B(t,c);js(e,N(h))&&(a=pn(n,a,h,d,i,r,o))}),s.foreach((c,d)=>{const h=B(t,c);js(e,N(h))||(a=pn(n,a,h,d,i,r,o))}),a}function As(n,e,t){return t.foreach((s,i)=>{e=e.updateChild(s,i)}),e}function gn(n,e,t,s,i,r,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,d;E(t)?d=s:d=new M(null).setTree(t,s);const h=e.serverCache.getNode();return d.children.inorderTraversal((u,f)=>{if(h.hasChild(u)){const m=e.serverCache.getNode().getImmediateChild(u),_=As(n,m,f);c=Ot(n,c,new P(u),_,i,r,o,a)}}),d.children.inorderTraversal((u,f)=>{const m=!e.serverCache.isCompleteForChild(u)&&f.value===null;if(!h.hasChild(u)&&!m){const _=e.serverCache.getNode().getImmediateChild(u),v=As(n,_,f);c=Ot(n,c,new P(u),v,i,r,o,a)}}),c}function ia(n,e,t,s,i,r,o){if(Pt(i,t)!=null)return e;const a=e.serverCache.isFiltered(),c=e.serverCache;if(s.value!=null){if(E(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return Ot(n,e,t,c.getNode().getChild(t),i,r,a,o);if(E(t)){let d=new M(null);return c.getNode().forEachChild(Ye,(h,u)=>{d=d.set(new P(h),u)}),gn(n,e,t,d,i,r,a,o)}else return e}else{let d=new M(null);return s.foreach((h,u)=>{const f=B(t,h);c.isCompleteForPath(f)&&(d=d.set(h,c.getNode().getChild(f)))}),gn(n,e,t,d,i,r,a,o)}}function ra(n,e,t,s,i){const r=e.serverCache,o=Bi(e,r.getNode(),r.isFullyInitialized()||E(t),r.isFiltered());return Qi(n,o,t,s,Yi,i)}function oa(n,e,t,s,i,r){let o;if(Pt(s,t)!=null)return e;{const a=new On(s,e,i),c=e.eventCache.getNode();let d;if(E(t)||N(t)===".priority"){let h;if(e.serverCache.isFullyInitialized())h=fn(s,He(e));else{const u=e.serverCache.getNode();p(u instanceof I,"serverChildren would be complete if leaf node"),h=$i(s,u)}h=h,d=n.filter.updateFullNode(c,h,r)}else{const h=N(t);let u=Pn(s,h,e.serverCache);u==null&&e.serverCache.isCompleteForChild(h)&&(u=c.getImmediateChild(h)),u!=null?d=n.filter.updateChild(c,h,u,D(t),a,r):e.eventCache.getNode().hasChild(h)?d=n.filter.updateChild(c,h,I.EMPTY_NODE,D(t),a,r):d=c,d.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=fn(s,He(e)),o.isLeafNode()&&(d=n.filter.updateFullNode(d,o,r)))}return o=e.serverCache.isFullyInitialized()||Pt(s,R())!=null,ft(e,d,o,n.filter.filtersNodes())}}function la(n,e){const t=He(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!E(e)&&!t.getImmediateChild(N(e)).isEmpty())?t.getChild(e):null}function Ls(n,e,t,s){e.type===pe.MERGE&&e.source.queryId!==null&&(p(He(n.viewCache_),"We should always have a full cache before handling merges"),p(dn(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,r=ta(n.processor_,i,e,t,s);return ea(n.processor_,r.viewCache),p(r.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=r.viewCache,aa(n,r.changes,r.viewCache.eventCache.getNode())}function aa(n,e,t,s){const i=n.eventRegistrations_;return Dl(n.eventGenerator_,e,t,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ms;function ca(n){p(!Ms,"__referenceConstructor has already been defined"),Ms=n}function Fn(n,e,t,s){const i=e.source.queryId;if(i!==null){const r=n.views.get(i);return p(r!=null,"SyncTree gave us an op for an invalid query."),Ls(r,e,t,s)}else{let r=[];for(const o of n.views.values())r=r.concat(Ls(o,e,t,s));return r}}function Hn(n,e){let t=null;for(const s of n.views.values())t=t||la(s,e);return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ds;function da(n){p(!Ds,"__referenceConstructor has already been defined"),Ds=n}class Ps{constructor(e){this.listenProvider_=e,this.syncPointTree_=new M(null),this.pendingWriteTree_=Yl(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function ha(n,e,t,s,i){return Hl(n.pendingWriteTree_,e,t,s,i),i?Vt(n,new Fe(Fi(),e,t)):[]}function $e(n,e,t=!1){const s=Ul(n.pendingWriteTree_,e);if(Wl(n.pendingWriteTree_,e)){let r=new M(null);return s.snap!=null?r=r.set(R(),!0):se(s.children,o=>{r=r.set(new P(o),!0)}),Vt(n,new Dt(s.path,r,t))}else return[]}function Gt(n,e,t){return Vt(n,new Fe(Hi(),e,t))}function ua(n,e,t){const s=M.fromObject(t);return Vt(n,new mt(Hi(),e,s))}function fa(n,e,t,s){const i=tr(n,s);if(i!=null){const r=nr(i),o=r.path,a=r.queryId,c=ne(o,e),d=new Fe(Ui(a),c,t);return sr(n,o,d)}else return[]}function pa(n,e,t,s){const i=tr(n,s);if(i){const r=nr(i),o=r.path,a=r.queryId,c=ne(o,e),d=M.fromObject(t),h=new mt(Ui(a),c,d);return sr(n,o,h)}else return[]}function Xi(n,e,t){const i=n.pendingWriteTree_,r=n.syncPointTree_.findOnPath(e,(o,a)=>{const c=ne(o,e),d=Hn(a,c);if(d)return d});return qi(i,e,r,t,!0)}function Vt(n,e){return Ji(e,n.syncPointTree_,null,Vi(n.pendingWriteTree_,R()))}function Ji(n,e,t,s){if(E(n.path))return er(n,e,t,s);{const i=e.get(R());t==null&&i!=null&&(t=Hn(i,R()));let r=[];const o=N(n.path),a=n.operationForChild(o),c=e.children.get(o);if(c&&a){const d=t?t.getImmediateChild(o):null,h=Ki(s,o);r=r.concat(Ji(a,c,d,h))}return i&&(r=r.concat(Fn(i,n,s,t))),r}}function er(n,e,t,s){const i=e.get(R());t==null&&i!=null&&(t=Hn(i,R()));let r=[];return e.children.inorderTraversal((o,a)=>{const c=t?t.getImmediateChild(o):null,d=Ki(s,o),h=n.operationForChild(o);h&&(r=r.concat(er(h,a,c,d)))}),i&&(r=r.concat(Fn(i,n,s,t))),r}function tr(n,e){return n.tagToQueryMap.get(e)}function nr(n){const e=n.indexOf("$");return p(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new P(n.substr(0,e))}}function sr(n,e,t){const s=n.syncPointTree_.get(e);p(s,"Missing sync point for query tag that we're tracking");const i=Vi(n.pendingWriteTree_,e);return Fn(s,t,i,null)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Un(t)}node(){return this.node_}}class Wn{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=B(this.path_,e);return new Wn(this.syncTree_,t)}node(){return Xi(this.syncTree_,this.path_)}}const ga=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},Os=function(n,e,t){if(!n||typeof n!="object")return n;if(p(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return ma(n[".sv"],e,t);if(typeof n[".sv"]=="object")return _a(n[".sv"],e);p(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},ma=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:p(!1,"Unexpected server value: "+n)}},_a=function(n,e,t){n.hasOwnProperty("increment")||p(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const s=n.increment;typeof s!="number"&&p(!1,"Unexpected increment value: "+s);const i=e.node();if(p(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return s;const o=i.getValue();return typeof o!="number"?s:o+s},ya=function(n,e,t,s){return Bn(e,new Wn(t,n),s)},Ca=function(n,e,t){return Bn(n,new Un(e),t)};function Bn(n,e,t){const s=n.getPriority().val(),i=Os(s,e.getImmediateChild(".priority"),t);let r;if(n.isLeafNode()){const o=n,a=Os(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new U(a,$(i)):n}else{const o=n;return r=o,i!==o.getPriority().val()&&(r=r.updatePriority(new U(i))),o.forEachChild(K,(a,c)=>{const d=Bn(c,e.getImmediateChild(a),t);d!==c&&(r=r.updateImmediateChild(a,d))}),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e="",t=null,s={children:{},childCount:0}){this.name=e,this.parent=t,this.node=s}}function Vn(n,e){let t=e instanceof P?e:new P(e),s=n,i=N(t);for(;i!==null;){const r=Xe(s.node.children,i)||{children:{},childCount:0};s=new Gn(i,s,r),t=D(t),i=N(t)}return s}function nt(n){return n.node.value}function ir(n,e){n.node.value=e,mn(n)}function rr(n){return n.node.childCount>0}function xa(n){return nt(n)===void 0&&!rr(n)}function zt(n,e){se(n.node.children,(t,s)=>{e(new Gn(t,n,s))})}function or(n,e,t,s){t&&e(n),zt(n,i=>{or(i,e,!0)})}function va(n,e,t){let s=n.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function Et(n){return new P(n.parent===null?n.name:Et(n.parent)+"/"+n.name)}function mn(n){n.parent!==null&&wa(n.parent,n.name,n)}function wa(n,e,t){const s=xa(t),i=Ee(n.node.children,e);s&&i?(delete n.node.children[e],n.node.childCount--,mn(n)):!s&&!i&&(n.node.children[e]=t.node,n.node.childCount++,mn(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ba=/[\[\].#$\/\u0000-\u001F\u007F]/,Ea=/[\[\].#$\u0000-\u001F\u007F]/,en=10*1024*1024,lr=function(n){return typeof n=="string"&&n.length!==0&&!ba.test(n)},Na=function(n){return typeof n=="string"&&n.length!==0&&!Ea.test(n)},Sa=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Na(n)},ar=function(n,e,t){const s=t instanceof P?new rl(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Me(s));if(typeof e=="function")throw new Error(n+"contains a function "+Me(s)+" with contents = "+e.toString());if(oi(e))throw new Error(n+"contains "+e.toString()+" "+Me(s));if(typeof e=="string"&&e.length>en/3&&Ht(e)>en)throw new Error(n+"contains a string greater than "+en+" utf8 bytes "+Me(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,r=!1;if(se(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(r=!0,!lr(o)))throw new Error(n+" contains an invalid key ("+o+") "+Me(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);ol(s,o),ar(n,a,s),ll(s)}),i&&r)throw new Error(n+' contains ".value" child '+Me(s)+" in addition to actual children.")}},Ta=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!lr(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!Sa(t))throw new Error(Hr(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function ka(n,e){let t=null;for(let s=0;s<e.length;s++){const i=e[s],r=i.getPath();t!==null&&!Ri(r,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:r}),t.events.push(i)}t&&n.eventLists_.push(t)}function We(n,e,t){ka(n,t),Ra(n,s=>re(s,e)||re(e,s))}function Ra(n,e){n.recursionDepth_++;let t=!0;for(let s=0;s<n.eventLists_.length;s++){const i=n.eventLists_[s];if(i){const r=i.path;e(r)?(ja(n.eventLists_[s]),n.eventLists_[s]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function ja(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const s=t.getEventRunner();ht&&q("event: "+t.toString()),wt(s)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aa="repo_interrupt",La=25;class Ma{constructor(e,t,s,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=s,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Ia,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Mt(),this.transactionQueueTree_=new Gn,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Da(n,e,t){if(n.stats_=Rn(n.repoInfo_),n.forceRestClient_||Ro())n.server_=new Lt(n.repoInfo_,(s,i,r,o)=>{Fs(n,s,i,r,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>Hs(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{V(t)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}n.persistentConnection_=new we(n.repoInfo_,e,(s,i,r,o)=>{Fs(n,s,i,r,o)},s=>{Hs(n,s)},s=>{Oa(n,s)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(s=>{n.server_.refreshAuthToken(s)}),n.appCheckProvider_.addTokenChangeListener(s=>{n.server_.refreshAppCheckToken(s.token)}),n.statsReporter_=Do(n.repoInfo_,()=>new Ml(n.stats_,n.server_)),n.infoData_=new kl,n.infoSyncTree_=new Ps({startListening:(s,i,r,o)=>{let a=[];const c=n.infoData_.getNode(s._path);return c.isEmpty()||(a=Gt(n.infoSyncTree_,s._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),zn(n,"connected",!1),n.serverSyncTree_=new Ps({startListening:(s,i,r,o)=>(n.server_.listen(s,r,i,(a,c)=>{const d=o(a,c);We(n.eventQueue_,s._path,d)}),[]),stopListening:(s,i)=>{n.server_.unlisten(s,i)}})}function Pa(n){const t=n.infoData_.getNode(new P(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function cr(n){return ga({timestamp:Pa(n)})}function Fs(n,e,t,s,i){n.dataUpdateCount++;const r=new P(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(s){const c=kt(t,d=>$(d));o=pa(n.serverSyncTree_,r,c,i)}else{const c=$(t);o=fa(n.serverSyncTree_,r,c,i)}else if(s){const c=kt(t,d=>$(d));o=ua(n.serverSyncTree_,r,c)}else{const c=$(t);o=Gt(n.serverSyncTree_,r,c)}let a=r;o.length>0&&(a=$n(n,r)),We(n.eventQueue_,a,o)}function Hs(n,e){zn(n,"connected",e),e===!1&&Ha(n)}function Oa(n,e){se(e,(t,s)=>{zn(n,t,s)})}function zn(n,e,t){const s=new P("/.info/"+e),i=$(t);n.infoData_.updateSnapshot(s,i);const r=Gt(n.infoSyncTree_,s,i);We(n.eventQueue_,s,r)}function Fa(n){return n.nextWriteId_++}function Ha(n){dr(n,"onDisconnectEvents");const e=cr(n),t=Mt();cn(n.onDisconnect_,R(),(i,r)=>{const o=ya(i,r,n.serverSyncTree_,e);Oi(t,i,o)});let s=[];cn(t,R(),(i,r)=>{s=s.concat(Gt(n.serverSyncTree_,i,r));const o=Ga(n,i);$n(n,o)}),n.onDisconnect_=Mt(),We(n.eventQueue_,R(),s)}function Ua(n){n.persistentConnection_&&n.persistentConnection_.interrupt(Aa)}function dr(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),q(t,...e)}function hr(n,e,t){return Xi(n.serverSyncTree_,e,t)||I.EMPTY_NODE}function qn(n,e=n.transactionQueueTree_){if(e||qt(n,e),nt(e)){const t=fr(n,e);p(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&Wa(n,Et(e),t)}else rr(e)&&zt(e,t=>{qn(n,t)})}function Wa(n,e,t){const s=t.map(d=>d.currentWriteId),i=hr(n,e,s);let r=i;const o=i.hash();for(let d=0;d<t.length;d++){const h=t[d];p(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;const u=ne(e,h.path);r=r.updateChild(u,h.currentOutputSnapshotRaw)}const a=r.val(!0),c=e;n.server_.put(c.toString(),a,d=>{dr(n,"transaction put response",{path:c.toString(),status:d});let h=[];if(d==="ok"){const u=[];for(let f=0;f<t.length;f++)t[f].status=2,h=h.concat($e(n.serverSyncTree_,t[f].currentWriteId)),t[f].onComplete&&u.push(()=>t[f].onComplete(null,!0,t[f].currentOutputSnapshotResolved)),t[f].unwatcher();qt(n,Vn(n.transactionQueueTree_,e)),qn(n,n.transactionQueueTree_),We(n.eventQueue_,e,h);for(let f=0;f<u.length;f++)wt(u[f])}else{if(d==="datastale")for(let u=0;u<t.length;u++)t[u].status===3?t[u].status=4:t[u].status=0;else{J("transaction at "+c.toString()+" failed: "+d);for(let u=0;u<t.length;u++)t[u].status=4,t[u].abortReason=d}$n(n,e)}},o)}function $n(n,e){const t=ur(n,e),s=Et(t),i=fr(n,t);return Ba(n,i,s),s}function Ba(n,e,t){if(e.length===0)return;const s=[];let i=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const c=e[a],d=ne(t,c.path);let h=!1,u;if(p(d!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)h=!0,u=c.abortReason,i=i.concat($e(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=La)h=!0,u="maxretry",i=i.concat($e(n.serverSyncTree_,c.currentWriteId,!0));else{const f=hr(n,c.path,o);c.currentInputSnapshot=f;const m=e[a].update(f.val());if(m!==void 0){ar("transaction failed: Data returned ",m,c.path);let _=$(m);typeof m=="object"&&m!=null&&Ee(m,".priority")||(_=_.updatePriority(f.getPriority()));const C=c.currentWriteId,k=cr(n),F=Ca(_,f,k);c.currentOutputSnapshotRaw=_,c.currentOutputSnapshotResolved=F,c.currentWriteId=Fa(n),o.splice(o.indexOf(C),1),i=i.concat(ha(n.serverSyncTree_,c.path,F,c.currentWriteId,c.applyLocally)),i=i.concat($e(n.serverSyncTree_,C,!0))}else h=!0,u="nodata",i=i.concat($e(n.serverSyncTree_,c.currentWriteId,!0))}We(n.eventQueue_,t,i),i=[],h&&(e[a].status=2,function(f){setTimeout(f,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(u==="nodata"?s.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):s.push(()=>e[a].onComplete(new Error(u),!1,null))))}qt(n,n.transactionQueueTree_);for(let a=0;a<s.length;a++)wt(s[a]);qn(n,n.transactionQueueTree_)}function ur(n,e){let t,s=n.transactionQueueTree_;for(t=N(e);t!==null&&nt(s)===void 0;)s=Vn(s,t),e=D(e),t=N(e);return s}function fr(n,e){const t=[];return pr(n,e,t),t.sort((s,i)=>s.order-i.order),t}function pr(n,e,t){const s=nt(e);if(s)for(let i=0;i<s.length;i++)t.push(s[i]);zt(e,i=>{pr(n,i,t)})}function qt(n,e){const t=nt(e);if(t){let s=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[s]=t[i],s++);t.length=s,ir(e,t.length>0?t:void 0)}zt(e,s=>{qt(n,s)})}function Ga(n,e){const t=Et(ur(n,e)),s=Vn(n.transactionQueueTree_,e);return va(s,i=>{tn(n,i)}),tn(n,s),or(s,i=>{tn(n,i)}),t}function tn(n,e){const t=nt(e);if(t){const s=[];let i=[],r=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(p(r===o-1,"All SENT items should be at beginning of queue."),r=o,t[o].status=3,t[o].abortReason="set"):(p(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat($e(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&s.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));r===-1?ir(e,void 0):t.length=r+1,We(n.eventQueue_,Et(e),i);for(let o=0;o<s.length;o++)wt(s[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Va(n){let e="";const t=n.split("/");for(let s=0;s<t.length;s++)if(t[s].length>0){let i=t[s];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function za(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const s=t.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):J(`Invalid query segment '${t}' in query '${n}'`)}return e}const Us=function(n,e){const t=qa(n),s=t.namespace;t.domain==="firebase.com"&&be(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&t.domain!=="localhost"&&be("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||wo();const i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new yi(t.host,t.secure,s,i,e,"",s!==t.subdomain),path:new P(t.pathString)}},qa=function(n){let e="",t="",s="",i="",r="",o=!0,a="https",c=443;if(typeof n=="string"){let d=n.indexOf("//");d>=0&&(a=n.substring(0,d-1),n=n.substring(d+2));let h=n.indexOf("/");h===-1&&(h=n.length);let u=n.indexOf("?");u===-1&&(u=n.length),e=n.substring(0,Math.min(h,u)),h<u&&(i=Va(n.substring(h,u)));const f=za(n.substring(Math.min(n.length,u)));d=e.indexOf(":"),d>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(d+1),10)):d=e.length;const m=e.slice(0,d);if(m.toLowerCase()==="localhost")t="localhost";else if(m.split(".").length<=2)t=m;else{const _=e.indexOf(".");s=e.substring(0,_).toLowerCase(),t=e.substring(_+1),r=s}"ns"in f&&(r=f.ns)}return{host:e,port:c,domain:t,subdomain:s,secure:o,scheme:a,pathString:i,namespace:r}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e,t,s,i){this._repo=e,this._path=t,this._queryParams=s,this._orderByCalled=i}get key(){return E(this._path)?null:Ti(this._path)}get ref(){return new st(this._repo,this._path)}get _queryIdentifier(){const e=Ns(this._queryParams),t=In(e);return t==="{}"?"default":t}get _queryObject(){return Ns(this._queryParams)}isEqual(e){if(e=Qs(e),!(e instanceof Kn))return!1;const t=this._repo===e._repo,s=Ri(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&s&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+il(this._path)}}class st extends Kn{constructor(e,t){super(e,t,new Mn,!1)}get parent(){const e=ki(this._path);return e===null?null:new st(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}ca(st);da(st);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $a="FIREBASE_DATABASE_EMULATOR_HOST",_n={};let Ka=!1;function Za(n,e,t,s){n.repoInfo_=new yi(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),s&&(n.authTokenProvider_=s)}function Ya(n,e,t,s,i){let r=s||n.options.databaseURL;r===void 0&&(n.options.projectId||be("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),q("Using default host for project ",n.options.projectId),r=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=Us(r,i),a=o.repoInfo,c;typeof process<"u"&&os&&(c=os[$a]),c?(r=`http://${c}?ns=${a.namespace}`,o=Us(r,i),a=o.repoInfo):o.repoInfo.secure;const d=new Ao(n.name,n.options,e);Ta("Invalid Firebase Database URL",o),E(o.path)||be("Database URL must point to the root of a Firebase Database (not including a child path).");const h=Xa(a,n,d,new jo(n.name,t));return new Ja(h,n)}function Qa(n,e){const t=_n[e];(!t||t[n.key]!==n)&&be(`Database ${e}(${n.repoInfo_}) has already been deleted.`),Ua(n),delete t[n.key]}function Xa(n,e,t,s){let i=_n[e.name];i||(i={},_n[e.name]=i);let r=i[n.toURLString()];return r&&be("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new Ma(n,Ka,t,s),i[n.toURLString()]=r,r}class Ja{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Da(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new st(this._repo,R())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Qa(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&be("Cannot call "+e+" on a deleted database.")}}function ec(n=Kr(),e){const t=Zr(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const s=Yr("database");s&&tc(t,...s)}return t}function tc(n,e,t,s={}){n=Qs(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&be("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let r;if(i.repoInfo_.nodeAdmin)s.mockUserToken&&be('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),r=new It(It.OWNER);else if(s.mockUserToken){const o=typeof s.mockUserToken=="string"?s.mockUserToken:Qr(s.mockUserToken,n.app.options.projectId);r=new It(o)}Za(i,e,t,r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nc(n){mo(Xr),Mr(new Dr("database",(e,{instanceIdentifier:t})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return Ya(s,i,r,t)},"PUBLIC").setMultipleInstances(!0)),ss(ls,as,n),ss(ls,as,"esm2017")}we.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};we.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};nc();const sc={apiKey:"AIzaSyBrAL5pz0IwE_w3hskBKcKBF4oDZlV_W1k",authDomain:"diggin-a08f8.firebaseapp.com",projectId:"diggin-a08f8",storageBucket:"diggin-a08f8.firebasestorage.app",messagingSenderId:"492982442570",appId:"1:492982442570:web:d71209728947131f8d64b3",databaseURL:"https://diggin-a08f8-default-rtdb.firebaseio.com"},Zn=Jr(sc),$t=eo(Zn),le=to(Zn);ec(Zn);const ic=async()=>{try{const n=new so,t=(await io($t,n)).user;return await Xs(Ut(le,"users",t.uid),{uid:t.uid,email:t.email,displayName:t.displayName,photoURL:t.photoURL,lastLogin:Ke()},{merge:!0}),t}catch(n){throw console.error("Error signing in with Google:",n),n}},rc=async()=>{try{await no($t)}catch(n){throw console.error("Error signing out:",n),n}},gr=x.createContext(void 0);function oc({children:n}){const[e,t]=x.useState(null),[s,i]=x.useState(!1),[r,o]=x.useState(null);x.useEffect(()=>{const h=Js($t,u=>{t(u)});return()=>h()},[]);const d={user:e,loading:s,error:r,signIn:async()=>{try{i(!0),o(null),await ic()}catch(h){throw console.error("Login failed:",h),o("An error occurred during login."),h}finally{i(!1)}},logOut:async()=>{try{i(!0),o(null),await rc()}catch(h){throw console.error("Logout failed:",h),o("An error occurred during logout."),h}finally{i(!1)}}};return l.jsx(gr.Provider,{value:d,children:n})}function Kt(){const n=x.useContext(gr);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n}function lc(){var c,d;const{user:n,loading:e,signIn:t,error:s}=Kt(),i=En(),o=((d=(c=$s().state)==null?void 0:c.from)==null?void 0:d.pathname)||"/holes";x.useEffect(()=>{n&&i(o,{replace:!0})},[n,i,o]);const a=async()=>{try{await t()}catch(h){console.error("Login failed:",h)}};return l.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gradient-to-br from-gray-50 to-gray-100",children:l.jsx("div",{className:"max-w-md w-full p-8 bg-white rounded-xl shadow-xl",children:l.jsxs("div",{className:"flex flex-col items-center space-y-6",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-950 rounded-full flex items-center justify-center",children:l.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),l.jsxs("div",{className:"text-center space-y-2",children:[l.jsx("h1",{className:"text-4xl font-bold text-gray-800",children:"Diggin"}),l.jsx("p",{className:"text-gray-500 text-lg",children:"Copy once. Dig deeper."})]}),l.jsxs("button",{onClick:a,disabled:e,className:"w-full py-3 mt-6 bg-gray-950 hover:bg-gray-800 transition-colors rounded-lg text-white font-medium shadow-md flex items-center justify-center",children:[e?l.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):l.jsx("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{d:"M12.545 10.239v3.821h5.445c-.712 2.315-2.647 3.972-5.445 3.972a6.033 6.033 0 110-12.064c1.498 0 2.866.549 3.921 1.453l2.814-2.814A9.969 9.969 0 0012.545 2C7.021 2 2.543 6.477 2.543 12s4.478 10 10.002 10c8.396 0 10.249-7.85 9.426-11.748l-9.426-.013z"})}),e?"Logging in...":"Log in with Google"]}),s&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 text-red-700 rounded-lg text-sm",children:s})]})})})}const ac=async(n,e,t)=>{try{const s=Ie(le,"holes"),i=Ke();return(await ei(s,{userId:n,name:e,icon:t,createdAt:i,updatedAt:i})).id}catch(s){throw console.error("Error creating hole:",s),s}},cc=async n=>{try{const e=Ut(le,"holes",n),t=await ro(e);return t.exists()?{id:t.id,...t.data()}:null}catch(e){throw console.error("Error getting hole:",e),e}},dc=async n=>{try{const e=yt(Ie(le,"holes"),Pe("userId","==",n),Tn("updatedAt","desc")),t=await Ct(e),s=[];return t.forEach(i=>{s.push({id:i.id,...i.data()})}),s}catch(e){throw console.error("Error getting user holes:",e),e}},yn=async n=>{try{const e=yt(Ie(le,"sessions"),Pe("holeId","==",n),Tn("startTime","desc")),t=await Ct(e),s=[];return t.forEach(i=>{s.push({id:i.id,...i.data()})}),s}catch(e){throw console.error("Error getting hole sessions:",e),e}},hc=async(n,e,t)=>{try{const s=Ie(le,"textEntries"),i=uc(t);return(await ei(s,{sessionId:n,content:e,sourceUrl:t,sourceDomain:i,capturedAt:Ke(),isBookmarked:!1})).id}catch(s){throw console.error("Error creating text entry:",s),s}},mr=async(n,e=20,t)=>{try{if(console.log(" [DEBUG] getSessionEntries called with:"),console.log("  sessionId:",n,"type:",typeof n),console.log("  pageSize:",e,"type:",typeof e),console.log("  lastDoc:",!!t),!n)throw console.error(" [ERROR] getSessionEntries: sessionId is falsy!",{sessionId:n,type:typeof n}),new Error(`getSessionEntries: Invalid sessionId: ${n}`);if(typeof n!="string")throw console.error(" [ERROR] getSessionEntries: sessionId is not a string!",{sessionId:n,type:typeof n}),new Error(`getSessionEntries: sessionId must be string, got ${typeof n}`);if(n.trim()==="")throw console.error(" [ERROR] getSessionEntries: sessionId is empty string!"),new Error("getSessionEntries: sessionId cannot be empty");if(console.log(" [DEBUG] getSessionEntries: sessionId validation passed"),e===0)return console.log(" [DEBUG] getSessionEntries: pageSize is 0, returning empty array for session initialization"),{entries:[],lastDoc:null,hasMore:!1};let s=yt(Ie(le,"textEntries"),Pe("sessionId","==",n),Tn("capturedAt","desc"),oo(e+1));console.log(" [DEBUG] getSessionEntries: About to execute Firebase query with sessionId:",n);const i=await Ct(s);console.log(" [DEBUG] getSessionEntries: Firebase query completed, docs count:",i.docs.length);const r=[],o=i.docs.length>e;(o?i.docs.slice(0,e):i.docs).forEach(d=>{r.push({id:d.id,...d.data()})});const c=i.docs.length>0?i.docs[i.docs.length-1]:null;return console.log(" [DEBUG] getSessionEntries: Returning",r.length,"entries"),{entries:r,lastDoc:c,hasMore:o}}catch(s){throw console.error("Error getting session entries:",s),console.error(" [DEBUG] getSessionEntries error details:"),console.error("  sessionId at error:",n,"type:",typeof n),console.error("  pageSize at error:",e),console.error("  Error stack:",s instanceof Error?s.stack:"No stack available"),s}},uc=n=>{try{return new URL(n).hostname}catch(e){return console.error("Error extracting domain:",e),n}},fc=async n=>{try{const e=Ut(le,"textEntries",n);await lo(e)}catch(e){throw console.error("Error deleting text entry:",e),e}};function _r(n){var e,t,s="";if(typeof n=="string"||typeof n=="number")s+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(e=0;e<i;e++)n[e]&&(t=_r(n[e]))&&(s&&(s+=" "),s+=t)}else for(t in n)n[t]&&(s&&(s+=" "),s+=t);return s}function pc(){for(var n,e,t=0,s="",i=arguments.length;t<i;t++)(n=arguments[t])&&(e=_r(n))&&(s&&(s+=" "),s+=e);return s}const Yn="-",gc=n=>{const e=_c(n),{conflictingClassGroups:t,conflictingClassGroupModifiers:s}=n;return{getClassGroupId:o=>{const a=o.split(Yn);return a[0]===""&&a.length!==1&&a.shift(),yr(a,e)||mc(o)},getConflictingClassGroupIds:(o,a)=>{const c=t[o]||[];return a&&s[o]?[...c,...s[o]]:c}}},yr=(n,e)=>{var o;if(n.length===0)return e.classGroupId;const t=n[0],s=e.nextPart.get(t),i=s?yr(n.slice(1),s):void 0;if(i)return i;if(e.validators.length===0)return;const r=n.join(Yn);return(o=e.validators.find(({validator:a})=>a(r)))==null?void 0:o.classGroupId},Ws=/^\[(.+)\]$/,mc=n=>{if(Ws.test(n)){const e=Ws.exec(n)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},_c=n=>{const{theme:e,prefix:t}=n,s={nextPart:new Map,validators:[]};return Cc(Object.entries(n.classGroups),t).forEach(([r,o])=>{Cn(o,s,r,e)}),s},Cn=(n,e,t,s)=>{n.forEach(i=>{if(typeof i=="string"){const r=i===""?e:Bs(e,i);r.classGroupId=t;return}if(typeof i=="function"){if(yc(i)){Cn(i(s),e,t,s);return}e.validators.push({validator:i,classGroupId:t});return}Object.entries(i).forEach(([r,o])=>{Cn(o,Bs(e,r),t,s)})})},Bs=(n,e)=>{let t=n;return e.split(Yn).forEach(s=>{t.nextPart.has(s)||t.nextPart.set(s,{nextPart:new Map,validators:[]}),t=t.nextPart.get(s)}),t},yc=n=>n.isThemeGetter,Cc=(n,e)=>e?n.map(([t,s])=>{const i=s.map(r=>typeof r=="string"?e+r:typeof r=="object"?Object.fromEntries(Object.entries(r).map(([o,a])=>[e+o,a])):r);return[t,i]}):n,xc=n=>{if(n<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,s=new Map;const i=(r,o)=>{t.set(r,o),e++,e>n&&(e=0,s=t,t=new Map)};return{get(r){let o=t.get(r);if(o!==void 0)return o;if((o=s.get(r))!==void 0)return i(r,o),o},set(r,o){t.has(r)?t.set(r,o):i(r,o)}}},Cr="!",vc=n=>{const{separator:e,experimentalParseClassName:t}=n,s=e.length===1,i=e[0],r=e.length,o=a=>{const c=[];let d=0,h=0,u;for(let C=0;C<a.length;C++){let k=a[C];if(d===0){if(k===i&&(s||a.slice(C,C+r)===e)){c.push(a.slice(h,C)),h=C+r;continue}if(k==="/"){u=C;continue}}k==="["?d++:k==="]"&&d--}const f=c.length===0?a:a.substring(h),m=f.startsWith(Cr),_=m?f.substring(1):f,v=u&&u>h?u-h:void 0;return{modifiers:c,hasImportantModifier:m,baseClassName:_,maybePostfixModifierPosition:v}};return t?a=>t({className:a,parseClassName:o}):o},wc=n=>{if(n.length<=1)return n;const e=[];let t=[];return n.forEach(s=>{s[0]==="["?(e.push(...t.sort(),s),t=[]):t.push(s)}),e.push(...t.sort()),e},bc=n=>({cache:xc(n.cacheSize),parseClassName:vc(n),...gc(n)}),Ec=/\s+/,Nc=(n,e)=>{const{parseClassName:t,getClassGroupId:s,getConflictingClassGroupIds:i}=e,r=[],o=n.trim().split(Ec);let a="";for(let c=o.length-1;c>=0;c-=1){const d=o[c],{modifiers:h,hasImportantModifier:u,baseClassName:f,maybePostfixModifierPosition:m}=t(d);let _=!!m,v=s(_?f.substring(0,m):f);if(!v){if(!_){a=d+(a.length>0?" "+a:a);continue}if(v=s(f),!v){a=d+(a.length>0?" "+a:a);continue}_=!1}const C=wc(h).join(":"),k=u?C+Cr:C,F=k+v;if(r.includes(F))continue;r.push(F);const Q=i(v,_);for(let z=0;z<Q.length;++z){const ae=Q[z];r.push(k+ae)}a=d+(a.length>0?" "+a:a)}return a};function Sc(){let n=0,e,t,s="";for(;n<arguments.length;)(e=arguments[n++])&&(t=xr(e))&&(s&&(s+=" "),s+=t);return s}const xr=n=>{if(typeof n=="string")return n;let e,t="";for(let s=0;s<n.length;s++)n[s]&&(e=xr(n[s]))&&(t&&(t+=" "),t+=e);return t};function Tc(n,...e){let t,s,i,r=o;function o(c){const d=e.reduce((h,u)=>u(h),n());return t=bc(d),s=t.cache.get,i=t.cache.set,r=a,a(c)}function a(c){const d=s(c);if(d)return d;const h=Nc(c,t);return i(c,h),h}return function(){return r(Sc.apply(null,arguments))}}const L=n=>{const e=t=>t[n]||[];return e.isThemeGetter=!0,e},vr=/^\[(?:([a-z-]+):)?(.+)\]$/i,Ic=/^\d+\/\d+$/,kc=new Set(["px","full","screen"]),Rc=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,jc=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Ac=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Lc=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Mc=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ce=n=>Qe(n)||kc.has(n)||Ic.test(n),Ne=n=>it(n,"length",Bc),Qe=n=>!!n&&!Number.isNaN(Number(n)),nn=n=>it(n,"number",Qe),ct=n=>!!n&&Number.isInteger(Number(n)),Dc=n=>n.endsWith("%")&&Qe(n.slice(0,-1)),w=n=>vr.test(n),Se=n=>Rc.test(n),Pc=new Set(["length","size","percentage"]),Oc=n=>it(n,Pc,wr),Fc=n=>it(n,"position",wr),Hc=new Set(["image","url"]),Uc=n=>it(n,Hc,Vc),Wc=n=>it(n,"",Gc),dt=()=>!0,it=(n,e,t)=>{const s=vr.exec(n);return s?s[1]?typeof e=="string"?s[1]===e:e.has(s[1]):t(s[2]):!1},Bc=n=>jc.test(n)&&!Ac.test(n),wr=()=>!1,Gc=n=>Lc.test(n),Vc=n=>Mc.test(n),zc=()=>{const n=L("colors"),e=L("spacing"),t=L("blur"),s=L("brightness"),i=L("borderColor"),r=L("borderRadius"),o=L("borderSpacing"),a=L("borderWidth"),c=L("contrast"),d=L("grayscale"),h=L("hueRotate"),u=L("invert"),f=L("gap"),m=L("gradientColorStops"),_=L("gradientColorStopPositions"),v=L("inset"),C=L("margin"),k=L("opacity"),F=L("padding"),Q=L("saturate"),z=L("scale"),ae=L("sepia"),ge=L("skew"),Re=L("space"),je=L("translate"),ce=()=>["auto","contain","none"],ee=()=>["auto","hidden","clip","visible","scroll"],me=()=>["auto",w,e],T=()=>[w,e],Ae=()=>["",Ce,Ne],_e=()=>["auto",Qe,w],Be=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],de=()=>["solid","dashed","dotted","double","none"],Ge=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ye=()=>["start","end","center","between","around","evenly","stretch"],y=()=>["","0",w],te=()=>["auto","avoid","all","avoid-page","page","left","right","column"],O=()=>[Qe,w];return{cacheSize:500,separator:":",theme:{colors:[dt],spacing:[Ce,Ne],blur:["none","",Se,w],brightness:O(),borderColor:[n],borderRadius:["none","","full",Se,w],borderSpacing:T(),borderWidth:Ae(),contrast:O(),grayscale:y(),hueRotate:O(),invert:y(),gap:T(),gradientColorStops:[n],gradientColorStopPositions:[Dc,Ne],inset:me(),margin:me(),opacity:O(),padding:T(),saturate:O(),scale:O(),sepia:y(),skew:O(),space:T(),translate:T()},classGroups:{aspect:[{aspect:["auto","square","video",w]}],container:["container"],columns:[{columns:[Se]}],"break-after":[{"break-after":te()}],"break-before":[{"break-before":te()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Be(),w]}],overflow:[{overflow:ee()}],"overflow-x":[{"overflow-x":ee()}],"overflow-y":[{"overflow-y":ee()}],overscroll:[{overscroll:ce()}],"overscroll-x":[{"overscroll-x":ce()}],"overscroll-y":[{"overscroll-y":ce()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[v]}],"inset-x":[{"inset-x":[v]}],"inset-y":[{"inset-y":[v]}],start:[{start:[v]}],end:[{end:[v]}],top:[{top:[v]}],right:[{right:[v]}],bottom:[{bottom:[v]}],left:[{left:[v]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",ct,w]}],basis:[{basis:me()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",w]}],grow:[{grow:y()}],shrink:[{shrink:y()}],order:[{order:["first","last","none",ct,w]}],"grid-cols":[{"grid-cols":[dt]}],"col-start-end":[{col:["auto",{span:["full",ct,w]},w]}],"col-start":[{"col-start":_e()}],"col-end":[{"col-end":_e()}],"grid-rows":[{"grid-rows":[dt]}],"row-start-end":[{row:["auto",{span:[ct,w]},w]}],"row-start":[{"row-start":_e()}],"row-end":[{"row-end":_e()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",w]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",w]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...ye()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...ye(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...ye(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[F]}],px:[{px:[F]}],py:[{py:[F]}],ps:[{ps:[F]}],pe:[{pe:[F]}],pt:[{pt:[F]}],pr:[{pr:[F]}],pb:[{pb:[F]}],pl:[{pl:[F]}],m:[{m:[C]}],mx:[{mx:[C]}],my:[{my:[C]}],ms:[{ms:[C]}],me:[{me:[C]}],mt:[{mt:[C]}],mr:[{mr:[C]}],mb:[{mb:[C]}],ml:[{ml:[C]}],"space-x":[{"space-x":[Re]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[Re]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",w,e]}],"min-w":[{"min-w":[w,e,"min","max","fit"]}],"max-w":[{"max-w":[w,e,"none","full","min","max","fit","prose",{screen:[Se]},Se]}],h:[{h:[w,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[w,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[w,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[w,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Se,Ne]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",nn]}],"font-family":[{font:[dt]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",w]}],"line-clamp":[{"line-clamp":["none",Qe,nn]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ce,w]}],"list-image":[{"list-image":["none",w]}],"list-style-type":[{list:["none","disc","decimal",w]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[n]}],"placeholder-opacity":[{"placeholder-opacity":[k]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[n]}],"text-opacity":[{"text-opacity":[k]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...de(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ce,Ne]}],"underline-offset":[{"underline-offset":["auto",Ce,w]}],"text-decoration-color":[{decoration:[n]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:T()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",w]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",w]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[k]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Be(),Fc]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Oc]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Uc]}],"bg-color":[{bg:[n]}],"gradient-from-pos":[{from:[_]}],"gradient-via-pos":[{via:[_]}],"gradient-to-pos":[{to:[_]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[r]}],"rounded-s":[{"rounded-s":[r]}],"rounded-e":[{"rounded-e":[r]}],"rounded-t":[{"rounded-t":[r]}],"rounded-r":[{"rounded-r":[r]}],"rounded-b":[{"rounded-b":[r]}],"rounded-l":[{"rounded-l":[r]}],"rounded-ss":[{"rounded-ss":[r]}],"rounded-se":[{"rounded-se":[r]}],"rounded-ee":[{"rounded-ee":[r]}],"rounded-es":[{"rounded-es":[r]}],"rounded-tl":[{"rounded-tl":[r]}],"rounded-tr":[{"rounded-tr":[r]}],"rounded-br":[{"rounded-br":[r]}],"rounded-bl":[{"rounded-bl":[r]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[k]}],"border-style":[{border:[...de(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[k]}],"divide-style":[{divide:de()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...de()]}],"outline-offset":[{"outline-offset":[Ce,w]}],"outline-w":[{outline:[Ce,Ne]}],"outline-color":[{outline:[n]}],"ring-w":[{ring:Ae()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[n]}],"ring-opacity":[{"ring-opacity":[k]}],"ring-offset-w":[{"ring-offset":[Ce,Ne]}],"ring-offset-color":[{"ring-offset":[n]}],shadow:[{shadow:["","inner","none",Se,Wc]}],"shadow-color":[{shadow:[dt]}],opacity:[{opacity:[k]}],"mix-blend":[{"mix-blend":[...Ge(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Ge()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[s]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Se,w]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[h]}],invert:[{invert:[u]}],saturate:[{saturate:[Q]}],sepia:[{sepia:[ae]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[h]}],"backdrop-invert":[{"backdrop-invert":[u]}],"backdrop-opacity":[{"backdrop-opacity":[k]}],"backdrop-saturate":[{"backdrop-saturate":[Q]}],"backdrop-sepia":[{"backdrop-sepia":[ae]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",w]}],duration:[{duration:O()}],ease:[{ease:["linear","in","out","in-out",w]}],delay:[{delay:O()}],animate:[{animate:["none","spin","ping","pulse","bounce",w]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[z]}],"scale-x":[{"scale-x":[z]}],"scale-y":[{"scale-y":[z]}],rotate:[{rotate:[ct,w]}],"translate-x":[{"translate-x":[je]}],"translate-y":[{"translate-y":[je]}],"skew-x":[{"skew-x":[ge]}],"skew-y":[{"skew-y":[ge]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",w]}],accent:[{accent:["auto",n]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",w]}],"caret-color":[{caret:[n]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":T()}],"scroll-mx":[{"scroll-mx":T()}],"scroll-my":[{"scroll-my":T()}],"scroll-ms":[{"scroll-ms":T()}],"scroll-me":[{"scroll-me":T()}],"scroll-mt":[{"scroll-mt":T()}],"scroll-mr":[{"scroll-mr":T()}],"scroll-mb":[{"scroll-mb":T()}],"scroll-ml":[{"scroll-ml":T()}],"scroll-p":[{"scroll-p":T()}],"scroll-px":[{"scroll-px":T()}],"scroll-py":[{"scroll-py":T()}],"scroll-ps":[{"scroll-ps":T()}],"scroll-pe":[{"scroll-pe":T()}],"scroll-pt":[{"scroll-pt":T()}],"scroll-pr":[{"scroll-pr":T()}],"scroll-pb":[{"scroll-pb":T()}],"scroll-pl":[{"scroll-pl":T()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",w]}],fill:[{fill:[n,"none"]}],"stroke-w":[{stroke:[Ce,Ne,nn]}],stroke:[{stroke:[n,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},qc=Tc(zc);function X(...n){return qc(pc(n))}const br=Nn.forwardRef(({variant:n="primary",size:e="md",disabled:t=!1,isIconOnly:s=!1,showTooltip:i=!1,leftIcon:r,rightIcon:o,showLeftIcon:a=!1,showRightIcon:c=!1,tooltip:d,className:h,children:u,...f},m)=>{const _=X("inline-flex items-center justify-center rounded-lg transition-colors duration-200","focus:outline-none focus-visible:ring-2 focus-visible:ring-line-primary-light dark:focus-visible:ring-line-primary-dark focus-visible:ring-offset-2","relative group"),v={primary:X("bg-fill-primary-light dark:bg-fill-primary-dark","!text-text-inverted-light dark:!text-text-inverted-dark","hover:bg-gray-850 dark:hover:bg-gray-100","disabled:bg-fill-disabled-light dark:disabled:bg-fill-disabled-dark","disabled:text-text-disabled-light dark:disabled:text-text-disabled-dark","disabled:cursor-not-allowed"),secondary:X("bg-fill-secondary-light dark:bg-fill-secondary-dark","text-text-primary-light dark:text-text-primary-dark","border border-line-secondary-light dark:border-line-secondary-dark","hover:bg-gray-50 dark:hover:bg-gray-800","disabled:text-text-disabled-light dark:disabled:text-text-disabled-dark","disabled:border-line-disabled-light dark:disabled:border-line-disabled-dark","disabled:cursor-not-allowed"),tertiary:X("bg-transparent","text-text-primary-light dark:text-text-primary-dark","hover:bg-gray-50 dark:hover:bg-gray-800","disabled:text-text-disabled-light dark:disabled:text-text-disabled-dark","disabled:cursor-not-allowed")},C={sm:s?"w-7 h-7":X("px-4","h-[32px] min-w-[100px]","text-body-md-md leading-none gap-1.5"),md:s?"w-9 h-9":X("px-4","h-[40px] min-w-[100px]","text-body-md-md leading-none gap-2"),lg:s?"w-9 h-9":X("px-5","h-[48px] min-w-[100px]","text-body-lg-md leading-none gap-2")},k={primary:X("[&>svg]:text-icon-inverted-light dark:[&>svg]:text-icon-inverted-dark","disabled:[&>svg]:text-icon-disabled-light dark:disabled:[&>svg]:text-icon-disabled-dark"),secondary:X("[&>svg]:text-icon-primary-light dark:[&>svg]:text-icon-primary-dark","disabled:[&>svg]:text-icon-disabled-light dark:disabled:[&>svg]:text-icon-disabled-dark"),tertiary:X("[&>svg]:text-icon-primary-light dark:[&>svg]:text-icon-primary-dark","disabled:[&>svg]:text-icon-disabled-light dark:disabled:[&>svg]:text-icon-disabled-dark")};return l.jsxs("button",{ref:m,type:"button",disabled:t,className:X(_,v[n],C[e],k[n],s&&"flex items-center justify-center p-0",s?e==="sm"?"[&_svg]:w-4 [&_svg]:h-4":e==="md"?"[&_svg]:w-5 [&_svg]:h-5":"[&_svg]:w-6 [&_svg]:h-6":"[&_svg]:w-4 [&_svg]:h-4",h),...f,children:[a&&r&&!s&&l.jsx("span",{className:"flex items-center justify-center",children:r}),!s&&u,s&&r&&l.jsx("span",{className:"flex items-center justify-center",children:r}),c&&o&&!s&&l.jsx("span",{className:"flex items-center justify-center",children:o}),s&&i&&d&&l.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-1 bg-fill-dim50-light/50 dark:bg-fill-dim50-dark/50 rounded opacity-0 group-hover:opacity-100 transition-opacity",children:l.jsx("span",{className:"text-text-inverted-light dark:text-text-inverted-dark text-xs font-medium leading-none whitespace-nowrap",children:d})})]})});br.displayName="Button";const xe=Nn.forwardRef((n,e)=>l.jsx(br,{...n,ref:e}));xe.displayName="Button";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $c=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Kc=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),Gs=n=>{const e=Kc(n);return e.charAt(0).toUpperCase()+e.slice(1)},Er=(...n)=>n.filter((e,t,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Zc={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yc=x.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:s,className:i="",children:r,iconNode:o,...a},c)=>x.createElement("svg",{ref:c,...Zc,width:e,height:e,stroke:n,strokeWidth:s?Number(t)*24/Number(e):t,className:Er("lucide",i),...a},[...o.map(([d,h])=>x.createElement(d,h)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qc=(n,e)=>{const t=x.forwardRef(({className:s,...i},r)=>x.createElement(Yc,{ref:r,iconNode:e,className:Er(`lucide-${$c(Gs(n))}`,`lucide-${n}`,s),...i}));return t.displayName=Gs(n),t};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xc=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Jc=Qc("x",Xc),ed={sm:"h-8 text-body-md-rg pl-3 pr-[40px]",md:"h-10 text-body-md-rg pl-3 pr-[40px]",lg:"h-12 text-body-md-rg pl-3 pr-[44px]"},td={sm:"right-3",md:"right-3",lg:"right-4"},Vs={default:"bg-fill-onsurface-light dark:bg-fill-onsurface-dark text-text-primary-light dark:text-text-primary-dark placeholder:text-text-tertiary-light dark:placeholder:text-text-tertiary-dark",disabled:"bg-fill-disabled-light dark:bg-fill-disabled-dark placeholder:text-text-disabled-light dark:placeholder:text-text-disabled-dark cursor-not-allowed"},Ft=x.forwardRef(({size:n="md",className:e,isDisabled:t,error:s,onChange:i,value:r,defaultValue:o,...a},c)=>{const[d,h]=x.useState(r||o||""),u=m=>{h(m.target.value),i==null||i(m)},f=()=>{h("");const m=new Event("input",{bubbles:!0}),_=c;_.current&&(Object.defineProperty(m,"target",{value:_.current}),_.current.value="",_.current.dispatchEvent(m))};return l.jsxs("div",{className:"relative w-full",children:[l.jsx("input",{ref:c,type:"text",value:d,onChange:u,className:X("w-full rounded-lg outline-none transition-colors",ed[n],t?Vs.disabled:Vs.default,s&&"border-border-error-light dark:border-border-error-dark",e),disabled:t,...a}),d&&!t&&l.jsx("button",{type:"button",onClick:f,className:X("absolute top-1/2 -translate-y-1/2",td[n],"text-icon-secondary-light dark:text-icon-secondary-dark","focus:outline-none"),children:l.jsx(Jc,{className:"w-4 h-4"})})]})});Ft.displayName="SingleLineTextField";const nd=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12 4C12.5523 4 13 4.44772 13 5V11H19C19.5523 11 20 11.4477 20 12C20 12.5523 19.5523 13 19 13H13V19C13 19.5523 12.5523 20 12 20C11.4477 20 11 19.5523 11 19V13H5C4.44772 13 4 12.5523 4 12C4 11.4477 4.44772 11 5 11H11V5C11 4.44772 11.4477 4 12 4Z",fill:"currnetColor"})}),sd=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.10561 3.00004C5.13078 3.00006 5.15619 3.00008 5.18187 3.00008H18.8181C18.8438 3.00008 18.8692 3.00006 18.8944 3.00004C19.2405 2.99977 19.5385 2.99953 19.8047 3.05196C20.8866 3.26501 21.7323 4.10227 21.9475 5.17332C22.0005 5.4369 22.0002 5.73195 22 6.07458C21.9999 6.09949 21.9999 6.12465 21.9999 6.15006C21.9999 6.17548 21.9999 6.20064 22 6.22555C22.0002 6.56818 22.0005 6.86323 21.9475 7.1268C21.758 8.06989 21.0797 8.8317 20.1818 9.14573V15.8172C20.1818 16.5417 20.1818 17.1396 20.1416 17.6267C20.0998 18.1325 20.0102 18.5976 19.7854 19.0344C19.4368 19.7118 18.8805 20.2625 18.1963 20.6076C17.7551 20.8302 17.2853 20.9189 16.7743 20.9602C16.2824 21 15.6784 21 14.9466 21H9.05336C8.32159 21 7.71764 21 7.22565 20.9602C6.71466 20.9189 6.24493 20.8302 5.80372 20.6076C5.1195 20.2625 4.56321 19.7118 4.21458 19.0344C3.98978 18.5976 3.90017 18.1325 3.85842 17.6267C3.81823 17.1396 3.81823 16.5417 3.81825 15.8172L3.81825 9.14573C2.92029 8.8317 2.24197 8.06989 2.05248 7.1268C1.99953 6.86324 1.99976 6.56819 2.00004 6.22556C2.00006 6.20065 2.00008 6.17549 2.00008 6.15006C2.00008 6.12464 2.00006 6.09948 2.00004 6.07457C1.99976 5.73194 1.99953 5.43689 2.05248 5.17333C2.26768 4.10227 3.1134 3.26501 4.19527 3.05196C4.4615 2.99953 4.75953 2.99977 5.10561 3.00004ZM5.63641 9.30005V15.78C5.63641 16.5509 5.63712 17.075 5.67055 17.4801C5.70311 17.8747 5.76214 18.0764 5.83458 18.2172C6.0089 18.5559 6.28704 18.8313 6.62915 19.0038C6.77133 19.0755 6.97515 19.134 7.37371 19.1662C7.78288 19.1993 8.31223 19.2 9.09093 19.2H14.9091C15.6878 19.2 16.2171 19.1993 16.6263 19.1662C17.0248 19.134 17.2287 19.0755 17.3708 19.0038C17.713 18.8312 17.9911 18.5559 18.1654 18.2172C18.2379 18.0764 18.2969 17.8747 18.3294 17.4801C18.3629 17.075 18.3636 16.5509 18.3636 15.78V9.30005H5.63641ZM19.1974 7.50006H4.80259C4.78546 7.49866 4.76818 7.49774 4.75078 7.49729C4.62029 7.49396 4.57209 7.48712 4.54998 7.48277C4.18935 7.41175 3.90745 7.13266 3.83571 6.77564C3.82265 6.71062 3.81825 6.61139 3.81825 6.15006C3.81825 5.68874 3.82265 5.58951 3.83571 5.52449C3.90745 5.16747 4.18935 4.88838 4.54998 4.81736C4.61566 4.80443 4.71589 4.80007 5.18187 4.80007H18.8181C19.2841 4.80007 19.3843 4.80443 19.45 4.81736C19.8106 4.88838 20.0926 5.16747 20.1643 5.52449C20.1774 5.58951 20.1818 5.68874 20.1818 6.15006C20.1818 6.61139 20.1774 6.71062 20.1643 6.77564C20.0926 7.13266 19.8106 7.41175 19.45 7.48277C19.4279 7.48712 19.3797 7.49396 19.2492 7.49729C19.2318 7.49774 19.2145 7.49866 19.1974 7.50006ZM9.27275 12.9C9.27275 12.403 9.67976 12 10.1818 12H13.8182C14.3202 12 14.7273 12.403 14.7273 12.9C14.7273 13.3971 14.3202 13.8 13.8182 13.8H10.1818C9.67976 13.8 9.27275 13.3971 9.27275 12.9Z",fill:"currentColor"})}),Nr=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M16.6339 4.33474C17.122 4.78105 17.122 5.50467 16.6339 5.95098L10.0178 12L16.6339 18.049C17.122 18.4953 17.122 19.219 16.6339 19.6653C16.1457 20.1116 15.3543 20.1116 14.8661 19.6653L7.36612 12.8081C6.87796 12.3618 6.87796 11.6382 7.36612 11.1919L14.8661 4.33474C15.3543 3.88842 16.1457 3.88842 16.6339 4.33474Z",fill:"currentColor"})}),id=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M21.6746 4.33795C22.1085 4.78856 22.1085 5.51913 21.6746 5.96974L9.45234 18.662C9.01843 19.1127 8.31491 19.1127 7.88099 18.662L2.32544 12.8928C1.89152 12.4422 1.89152 11.7116 2.32544 11.261C2.75935 10.8104 3.46287 10.8104 3.89679 11.261L8.66667 16.2144L20.1032 4.33795C20.5371 3.88735 21.2406 3.88735 21.6746 4.33795Z",fill:"currentColor"})}),Qn=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8.29289 5.29289C8.68342 4.90237 9.31658 4.90237 9.70711 5.29289L15.7071 11.2929C16.0976 11.6834 16.0976 12.3166 15.7071 12.7071L9.70711 18.7071C9.31658 19.0976 8.68342 19.0976 8.29289 18.7071C7.90237 18.3166 7.90237 17.6834 8.29289 17.2929L13.5858 12L8.29289 6.70711C7.90237 6.31658 7.90237 5.68342 8.29289 5.29289Z",fill:"currentColor"})}),Sr=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.29289 5.29289C5.68342 4.90237 6.31658 4.90237 6.70711 5.29289L12 10.5858L17.2929 5.29289C17.6834 4.90237 18.3166 4.90237 18.7071 5.29289C19.0976 5.68342 19.0976 6.31658 18.7071 6.70711L13.4142 12L18.7071 17.2929C19.0976 17.6834 19.0976 18.3166 18.7071 18.7071C18.3166 19.0976 17.6834 19.0976 17.2929 18.7071L12 13.4142L6.70711 18.7071C6.31658 19.0976 5.68342 19.0976 5.29289 18.7071C4.90237 18.3166 4.90237 17.6834 5.29289 17.2929L10.5858 12L5.29289 6.70711C4.90237 6.31658 4.90237 5.68342 5.29289 5.29289Z",fill:"currentColor"})}),rd=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M15.793 2.79287C17.0119 1.57393 18.9882 1.57392 20.2072 2.79287C21.4261 4.01183 21.4261 5.98814 20.2072 7.20709L7.64443 19.7698C7.62463 19.7896 7.60501 19.8093 7.58555 19.8288C7.29811 20.1168 7.04467 20.3707 6.73914 20.5579C6.47072 20.7224 6.17809 20.8436 5.87198 20.9171C5.52354 21.0007 5.16479 21.0004 4.7579 21C4.73035 21 4.70258 21 4.67458 21H3.00004C2.44776 21 2.00004 20.5523 2.00004 20V18.3255C2.00004 18.2975 2.00001 18.2697 1.99999 18.2422C1.99961 17.8353 1.99928 17.4765 2.08293 17.1281C2.15642 16.822 2.27763 16.5293 2.44212 16.2609C2.62936 15.9554 2.88326 15.7019 3.17125 15.4145C3.19074 15.395 3.2104 15.3754 3.23019 15.3556L15.793 2.79287ZM18.793 4.20709C18.3551 3.76919 17.6451 3.76919 17.2072 4.20709L4.64441 16.7698C4.26484 17.1494 4.19486 17.2285 4.1474 17.3059C4.09257 17.3954 4.05217 17.4929 4.02767 17.595C4.00647 17.6833 4.00004 17.7887 4.00004 18.3255V19H4.67458C5.21137 19 5.31677 18.9936 5.40509 18.9724C5.50712 18.9479 5.60467 18.9075 5.69414 18.8526C5.77158 18.8052 5.85066 18.7352 6.23022 18.3556L18.793 5.79288C19.2309 5.35497 19.2309 4.64499 18.793 4.20709ZM11 20C11 19.4477 11.4477 19 12 19H21C21.5523 19 22 19.4477 22 20C22 20.5523 21.5523 21 21 21H12C11.4477 21 11 20.5523 11 20Z",fill:"currentColor"})}),Xn=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M2 6C2 5.44772 2.44772 5 3 5H21C21.5523 5 22 5.44772 22 6C22 6.55228 21.5523 7 21 7H3C2.44772 7 2 6.55228 2 6ZM5 12C5 11.4477 5.44772 11 6 11H18C18.5523 11 19 11.4477 19 12C19 12.5523 18.5523 13 18 13H6C5.44772 13 5 12.5523 5 12ZM8 18C8 17.4477 8.44772 17 9 17H15C15.5523 17 16 17.4477 16 18C16 18.5523 15.5523 19 15 19H9C8.44772 19 8 18.5523 8 18Z",fill:"currentColor"})}),xn=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M2 12C2 11.4477 2.44772 11 3 11L14.5858 11L10.2929 6.70711C9.90237 6.31658 9.90237 5.68342 10.2929 5.2929C10.6834 4.90237 11.3166 4.90237 11.7071 5.2929L17.7071 11.2929C18.0976 11.6834 18.0976 12.3166 17.7071 12.7071L11.7071 18.7071C11.3166 19.0976 10.6834 19.0976 10.2929 18.7071C9.90237 18.3166 9.90237 17.6834 10.2929 17.2929L14.5858 13L3 13C2.44772 13 2 12.5523 2 12ZM21 22C20.4477 22 20 21.5523 20 21L20 3C20 2.44772 20.4477 2 21 2C21.5523 2 22 2.44772 22 3L22 21C22 21.5523 21.5523 22 21 22Z",fill:"currentColor"})}),vn=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12 2C12.6137 2 13.1111 2.49746 13.1111 3.11111V9.31754L17.881 4.54766C18.3149 4.11374 19.0184 4.11374 19.4523 4.54766C19.8863 4.98158 19.8863 5.68509 19.4523 6.11901L14.6825 10.8889H20.8889C21.5025 10.8889 22 11.3864 22 12C22 12.6137 21.5025 13.1111 20.8889 13.1111H14.6825L19.4523 17.881C19.8863 18.3149 19.8863 19.0184 19.4523 19.4523C19.0184 19.8863 18.3149 19.8863 17.881 19.4523L13.1111 14.6825V20.8889C13.1111 21.5025 12.6137 22 12 22C11.3864 22 10.8889 21.5025 10.8889 20.8889V14.6825L6.11901 19.4523C5.68509 19.8863 4.98158 19.8863 4.54766 19.4523C4.11374 19.0184 4.11374 18.3149 4.54766 17.881L9.31754 13.1111H3.11111C2.49746 13.1111 2 12.6137 2 12C2 11.3864 2.49746 10.8889 3.11111 10.8889H9.31754L4.54766 6.11901C4.11374 5.68509 4.11374 4.98158 4.54766 4.54766C4.98158 4.11374 5.68509 4.11374 6.11901 4.54766L10.8889 9.31754V3.11111C10.8889 2.49746 11.3864 2 12 2Z",fill:"currentColor"})}),Jn=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M4 2.83744C4 1.82265 4.82265 1 5.83744 1H18.1626C19.1773 1 20 1.82265 20 2.83744C20 5.7679 18.8359 8.57833 16.7637 10.6505L15.5445 11.8697C15.4805 11.9337 15.4455 11.9688 15.4206 11.9951C15.4188 11.9969 15.4173 11.9985 15.4159 12C15.4173 12.0015 15.4188 12.0031 15.4206 12.0049C15.4455 12.0312 15.4805 12.0663 15.5445 12.1303L16.7637 13.3495C18.8359 15.4217 20 18.2321 20 21.1626C20 22.1774 19.1773 23 18.1626 23H5.83744C4.82265 23 4 22.1773 4 21.1626C4 18.2321 5.16412 15.4217 7.23627 13.3495L8.45545 12.1303L9.16256 12.8374L8.45545 12.1303C8.51952 12.0663 8.55448 12.0312 8.57945 12.0049C8.58115 12.0031 8.58271 12.0015 8.58412 12C8.58271 11.9985 8.58115 11.9969 8.57945 11.9951C8.55448 11.9688 8.51952 11.9337 8.45545 11.8697L7.23626 10.6505C5.16412 8.57833 4 5.7679 4 2.83744ZM6.00146 3C6.04347 5.34119 6.99176 7.57754 8.65048 9.23626L9.86966 10.4555C9.87827 10.4641 9.8871 10.4729 9.89614 10.4819C9.98812 10.5735 10.1003 10.6854 10.1892 10.8046L9.41382 11.3827L10.1892 10.8046C10.718 11.5138 10.718 12.4862 10.1892 13.1954L9.41382 12.6173L10.1892 13.1954C10.1003 13.3146 9.98812 13.4265 9.89613 13.5181C9.8871 13.5271 9.87826 13.5359 9.86966 13.5445L8.65048 14.7637C6.99176 16.4225 6.04347 18.6588 6.00146 21H17.9985C17.9565 18.6588 17.0082 16.4225 15.3495 14.7637L14.1303 13.5445C14.1217 13.5359 14.1129 13.5271 14.1039 13.5181C14.0119 13.4265 13.8997 13.3146 13.8108 13.1954C13.282 12.4862 13.282 11.5138 13.8108 10.8046C13.8997 10.6854 14.0119 10.5735 14.1039 10.4819C14.1129 10.4729 14.1217 10.4641 14.1303 10.4555L15.3495 9.23626C17.0082 7.57754 17.9565 5.34119 17.9985 3H6.00146Z",fill:"currentColor"})}),sn=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12 3C7.02944 3 3 7.02944 3 12C3 16.9706 7.02944 21 12 21C16.9706 21 21 16.9706 21 12C21 7.02944 16.9706 3 12 3ZM1 12C1 5.92487 5.92487 1 12 1C18.0751 1 23 5.92487 23 12C23 18.0751 18.0751 23 12 23C5.92487 23 1 18.0751 1 12ZM11 8C11 7.44772 11.4477 7 12 7H12.01C12.5623 7 13.01 7.44772 13.01 8C13.01 8.55228 12.5623 9 12.01 9H12C11.4477 9 11 8.55228 11 8ZM12 11C12.5523 11 13 11.4477 13 12V16C13 16.5523 12.5523 17 12 17C11.4477 17 11 16.5523 11 16V12C11 11.4477 11.4477 11 12 11Z",fill:"currentColor"})}),wn=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5 9.27273C5 5.25611 8.13401 2 12 2C15.866 2 19 5.25611 19 9.27273C19 11.966 17.5909 14.3157 15.5 15.5723V15.6654C15.5 16.0642 15.5 16.4083 15.4813 16.6931C15.4616 16.9929 15.4183 17.2928 15.3002 17.5891C15.0338 18.2574 14.5227 18.7883 13.8795 19.0651C13.5944 19.1879 13.3057 19.2329 13.0171 19.2533C12.743 19.2727 12.4118 19.2727 12.028 19.2727H11.972C11.5882 19.2727 11.257 19.2727 10.9829 19.2533C10.6943 19.2329 10.4056 19.1879 10.1205 19.0651C9.47726 18.7883 8.96624 18.2574 8.69982 17.5891C8.58169 17.2928 8.53837 16.9929 8.51868 16.6931C8.49998 16.4083 8.49999 16.0642 8.5 15.6654L8.5 15.5723C6.40908 14.3157 5 11.966 5 9.27273ZM12 3.81818C9.1005 3.81818 6.75 6.26026 6.75 9.27273C6.75 11.4473 7.97471 13.3264 9.75046 14.2028C10.0556 14.3534 10.25 14.673 10.25 15.024V15.6364C10.25 16.0724 10.2505 16.3539 10.2646 16.5693C10.2782 16.7766 10.3015 16.8555 10.3166 16.8933C10.4054 17.1161 10.5758 17.2931 10.7902 17.3853C10.8266 17.401 10.9025 17.4252 11.102 17.4394C11.3094 17.4541 11.5803 17.4545 12 17.4545C12.4197 17.4545 12.6906 17.4541 12.898 17.4394C13.0975 17.4252 13.1734 17.401 13.2098 17.3853C13.4242 17.2931 13.5946 17.1161 13.6834 16.8933C13.6985 16.8555 13.7218 16.7766 13.7354 16.5693C13.7495 16.3539 13.75 16.0724 13.75 15.6364V15.024C13.75 14.673 13.9444 14.3534 14.2495 14.2028C16.0253 13.3264 17.25 11.4473 17.25 9.27273C17.25 6.26026 14.8995 3.81818 12 3.81818ZM8.9375 21.0909C8.9375 20.5888 9.32925 20.1818 9.8125 20.1818H14.1875C14.6707 20.1818 15.0625 20.5888 15.0625 21.0909C15.0625 21.593 14.6707 22 14.1875 22H9.8125C9.32925 22 8.9375 21.593 8.9375 21.0909Z",fill:"currentColor"})}),od=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M14 3C14 2.44772 14.4477 2 15 2H21C21.5523 2 22 2.44771 22 3L22 9C22 9.55228 21.5523 10 21 10C20.4477 10 20 9.55229 20 9L20 5.41421L13.7071 11.7071C13.3166 12.0976 12.6834 12.0976 12.2929 11.7071C11.9024 11.3166 11.9024 10.6834 12.2929 10.2929L18.5858 4H15C14.4477 4 14 3.55228 14 3ZM7.7587 4L10 4C10.5523 4 11 4.44772 11 5C11 5.55228 10.5523 6 10 6H7.8C6.94342 6 6.36113 6.00078 5.91104 6.03755C5.47262 6.07337 5.24842 6.1383 5.09202 6.21799C4.7157 6.40973 4.40973 6.71569 4.21799 7.09202C4.1383 7.24842 4.07337 7.47262 4.03755 7.91104C4.00078 8.36113 4 8.94342 4 9.8V16.2C4 17.0566 4.00078 17.6389 4.03755 18.089C4.07337 18.5274 4.1383 18.7516 4.21799 18.908C4.40973 19.2843 4.7157 19.5903 5.09202 19.782C5.24842 19.8617 5.47262 19.9266 5.91104 19.9624C6.36113 19.9992 6.94342 20 7.8 20H14.2C15.0566 20 15.6389 19.9992 16.089 19.9624C16.5274 19.9266 16.7516 19.8617 16.908 19.782C17.2843 19.5903 17.5903 19.2843 17.782 18.908C17.8617 18.7516 17.9266 18.5274 17.9624 18.089C17.9992 17.6389 18 17.0566 18 16.2V14C18 13.4477 18.4477 13 19 13C19.5523 13 20 13.4477 20 14V16.2413C20 17.0463 20 17.7106 19.9558 18.2518C19.9099 18.8139 19.8113 19.3306 19.564 19.816C19.1805 20.5686 18.5686 21.1805 17.816 21.564C17.3306 21.8113 16.8139 21.9099 16.2518 21.9558C15.7106 22 15.0463 22 14.2413 22H7.75868C6.95372 22 6.28936 22 5.74817 21.9558C5.18608 21.9099 4.66937 21.8113 4.18404 21.564C3.43139 21.1805 2.81947 20.5686 2.43597 19.816C2.18868 19.3306 2.09012 18.8139 2.04419 18.2518C1.99998 17.7106 1.99999 17.0463 2 16.2413V9.7587C1.99999 8.95373 1.99998 8.28937 2.04419 7.74817C2.09012 7.18608 2.18868 6.66937 2.43597 6.18404C2.81947 5.43139 3.43139 4.81947 4.18404 4.43597C4.66937 4.18868 5.18608 4.09012 5.74818 4.04419C6.28937 3.99998 6.95373 3.99999 7.7587 4Z",fill:"currentColor"})}),ld=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10 5C10 3.89543 10.8954 3 12 3C13.1046 3 14 3.89543 14 5C14 6.10457 13.1046 7 12 7C10.8954 7 10 6.10457 10 5ZM10 12C10 10.8954 10.8954 10 12 10C13.1046 10 14 10.8954 14 12C14 13.1046 13.1046 14 12 14C10.8954 14 10 13.1046 10 12ZM10 19C10 17.8954 10.8954 17 12 17C13.1046 17 14 17.8954 14 19C14 20.1046 13.1046 21 12 21C10.8954 21 10 20.1046 10 19Z",fill:"currentColor"})}),ad=({className:n,...e})=>l.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("path",{d:"M6 4.5C6 3.67157 6.67157 3 7.5 3H9C9.82843 3 10.5 3.67157 10.5 4.5V19.5C10.5 20.3284 9.82843 21 9 21H7.5C6.67157 21 6 20.3284 6 19.5V4.5Z",fill:"currentColor"}),l.jsx("path",{d:"M13.5 4.5C13.5 3.67157 14.1716 3 15 3H16.5C17.3284 3 18 3.67157 18 4.5V19.5C18 20.3284 17.3284 21 16.5 21H15C14.1716 21 13.5 20.3284 13.5 19.5V4.5Z",fill:"currentColor"})]}),cd=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{d:"M6 4.98963C6 4.01847 6 3.53289 6.20249 3.26522C6.37889 3.03203 6.64852 2.88773 6.9404 2.8703C7.27544 2.8503 7.67946 3.11965 8.48752 3.65835L19.0031 10.6687C19.6708 11.1139 20.0046 11.3364 20.1209 11.6169C20.2227 11.8622 20.2227 12.1378 20.1209 12.3831C20.0046 12.6636 19.6708 12.8862 19.0031 13.3313L8.48752 20.3417C7.67946 20.8804 7.27544 21.1497 6.9404 21.1297C6.64852 21.1123 6.37889 20.968 6.20249 20.7348C6 20.4671 6 19.9815 6 19.0104V4.98963Z",fill:"currentColor"})}),dd=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M2 8.5C2 7.94772 2.44772 7.5 3 7.5H21C21.5523 7.5 22 7.94772 22 8.5C22 9.05228 21.5523 9.5 21 9.5H3C2.44772 9.5 2 9.05228 2 8.5ZM2 15.5C2 14.9477 2.44772 14.5 3 14.5H21C21.5523 14.5 22 14.9477 22 15.5C22 16.0523 21.5523 16.5 21 16.5H3C2.44772 16.5 2 16.0523 2 15.5Z",fill:"currentColor"})}),Tr=({className:n})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10 4C6.68629 4 4 6.68629 4 10C4 13.3137 6.68629 16 10 16C13.3137 16 16 13.3137 16 10C16 6.68629 13.3137 4 10 4ZM2 10C2 5.58172 5.58172 2 10 2C14.4183 2 18 5.58172 18 10C18 11.8487 17.3729 13.5509 16.3199 14.9056L21.7071 20.2929C22.0976 20.6834 22.0976 21.3166 21.7071 21.7071C21.3166 22.0976 20.6834 22.0976 20.2929 21.7071L14.9057 16.3198C13.551 17.3729 11.8487 18 10 18C5.58172 18 2 14.4183 2 10Z",fill:"currentColor"})}),hd=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M18 6C16.8954 6 16 6.89543 16 8C16 9.10457 16.8954 10 18 10C19.1046 10 20 9.10457 20 8C20 6.89543 19.1046 6 18 6ZM14.126 7C14.5701 5.27477 16.1362 4 18 4C20.2091 4 22 5.79086 22 8C22 10.2091 20.2091 12 18 12C16.1362 12 14.5701 10.7252 14.126 9L3 9C2.44772 9 2 8.55228 2 8C2 7.44772 2.44772 7 3 7L14.126 7ZM6 14C4.89543 14 4 14.8954 4 16C4 17.1046 4.89543 18 6 18C7.10457 18 8 17.1046 8 16C8 14.8954 7.10457 14 6 14ZM2 16C2 13.7909 3.79086 12 6 12C7.86384 12 9.42994 13.2748 9.87398 15L21 15C21.5523 15 22 15.4477 22 16C22 16.5523 21.5523 17 21 17L9.87398 17C9.42994 18.7252 7.86384 20 6 20C3.79086 20 2 18.2091 2 16Z",fill:"currentColor"})}),ud=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.29289 3.29289C6.68342 2.90237 7.31658 2.90237 7.70711 3.29289L11.7071 7.29289C12.0976 7.68342 12.0976 8.31658 11.7071 8.70711C11.3166 9.09763 10.6834 9.09763 10.2929 8.70711L8 6.41421V20C8 20.5523 7.55228 21 7 21C6.44772 21 6 20.5523 6 20V6.41421L3.70711 8.70711C3.31658 9.09763 2.68342 9.09763 2.29289 8.70711C1.90237 8.31658 1.90237 7.68342 2.29289 7.29289L6.29289 3.29289ZM16 17.5858V4C16 3.44772 16.4477 3 17 3C17.5523 3 18 3.44772 18 4V17.5858L20.2929 15.2929C20.6834 14.9024 21.3166 14.9024 21.7071 15.2929C22.0976 15.6834 22.0976 16.3166 21.7071 16.7071L17.7071 20.7071C17.3166 21.0976 16.6834 21.0976 16.2929 20.7071L12.2929 16.7071C11.9024 16.3166 11.9024 15.6834 12.2929 15.2929C12.6834 14.9024 13.3166 14.9024 13.7071 15.2929L16 17.5858Z",fill:"currentColor"})}),fd=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{className:"",d:"M3 7.8C3 6.11984 3 5.27976 3.32698 4.63803C3.6146 4.07354 4.07354 3.6146 4.63803 3.32698C5.27976 3 6.11984 3 7.8 3H16.2C17.8802 3 18.7202 3 19.362 3.32698C19.9265 3.6146 20.3854 4.07354 20.673 4.63803C21 5.27976 21 6.11984 21 7.8V16.2C21 17.8802 21 18.7202 20.673 19.362C20.3854 19.9265 19.9265 20.3854 19.362 20.673C18.7202 21 17.8802 21 16.2 21H7.8C6.11984 21 5.27976 21 4.63803 20.673C4.07354 20.3854 3.6146 19.9265 3.32698 19.362C3 18.7202 3 17.8802 3 16.2V7.8Z",fill:"currentColor"})}),es=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12 3.81818C7.48131 3.81818 3.81818 7.48131 3.81818 12C3.81818 16.5187 7.48131 20.1818 12 20.1818C16.5187 20.1818 20.1818 16.5187 20.1818 12C20.1818 7.48131 16.5187 3.81818 12 3.81818ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 5.63636C12.5021 5.63636 12.9091 6.04338 12.9091 6.54545V11.4382L16.0429 13.0051C16.492 13.2296 16.674 13.7757 16.4495 14.2247C16.2249 14.6738 15.6789 14.8558 15.2298 14.6313L11.5934 12.8131C11.2855 12.6591 11.0909 12.3443 11.0909 12V6.54545C11.0909 6.04338 11.4979 5.63636 12 5.63636Z",fill:"currentColor"})}),pd=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8 3C8 2.44772 8.44772 2 9 2H15C15.5523 2 16 2.44772 16 3C16 3.55228 15.5523 4 15 4H9C8.44772 4 8 3.55228 8 3ZM4.99224 5H3C2.44772 5 2 5.44772 2 6C2 6.55228 2.44772 7 3 7H4.06445L4.70614 16.6254C4.75649 17.3809 4.79816 18.006 4.87287 18.5149C4.95066 19.0447 5.07405 19.5288 5.33109 19.98C5.73123 20.6824 6.33479 21.247 7.06223 21.5996C7.52952 21.826 8.0208 21.917 8.55459 21.9593C9.06728 22 9.69383 22 10.4509 22H13.5491C14.3062 22 14.9327 22 15.4454 21.9593C15.9792 21.917 16.4705 21.826 16.9378 21.5996C17.6652 21.247 18.2688 20.6824 18.6689 19.98C18.926 19.5288 19.0493 19.0447 19.1271 18.5149C19.2018 18.006 19.2435 17.3808 19.2939 16.6253L19.9356 7H21C21.5523 7 22 6.55228 22 6C22 5.44772 21.5523 5 21 5H19.0078C19.0019 4.99995 18.9961 4.99995 18.9903 5H5.00974C5.00392 4.99995 4.99809 4.99995 4.99224 5ZM17.9311 7H6.06889L6.69907 16.4528C6.75274 17.2578 6.78984 17.8034 6.85166 18.2243C6.9117 18.6333 6.98505 18.8429 7.06888 18.99C7.26895 19.3412 7.57072 19.6235 7.93444 19.7998C8.08684 19.8736 8.30086 19.9329 8.71286 19.9656C9.13703 19.9993 9.68385 20 10.4907 20H13.5093C14.3161 20 14.863 19.9993 15.2871 19.9656C15.6991 19.9329 15.9132 19.8736 16.0656 19.7998C16.4293 19.6235 16.7311 19.3412 16.9311 18.99C17.015 18.8429 17.0883 18.6333 17.1483 18.2243C17.2102 17.8034 17.2473 17.2578 17.3009 16.4528L17.9311 7Z",fill:"currentColor"})}),gd=({className:n,...e})=>l.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.18182 2C5.6839 2 6.09091 2.40701 6.09091 2.90909V4.27273H7.45455C7.95662 4.27273 8.36364 4.67974 8.36364 5.18182C8.36364 5.6839 7.95662 6.09091 7.45455 6.09091H6.09091V7.45455C6.09091 7.95662 5.6839 8.36364 5.18182 8.36364C4.67974 8.36364 4.27273 7.95662 4.27273 7.45455V6.09091H2.90909C2.40701 6.09091 2 5.6839 2 5.18182C2 4.67974 2.40701 4.27273 2.90909 4.27273H4.27273V2.90909C4.27273 2.40701 4.67974 2 5.18182 2ZM12.9091 2.90909C13.2852 2.90909 13.6226 3.14075 13.7576 3.49184L15.3341 7.5908C15.6072 8.30084 15.693 8.50545 15.8104 8.67054C15.9282 8.83618 16.0729 8.9809 16.2386 9.09869C16.4036 9.21607 16.6082 9.30189 17.3183 9.57498L21.4173 11.1515C21.7683 11.2865 22 11.6238 22 12C22 12.3762 21.7683 12.7135 21.4173 12.8485L17.3183 14.425C16.6082 14.6981 16.4036 14.7839 16.2386 14.9013C16.0729 15.0191 15.9282 15.1638 15.8104 15.3295C15.693 15.4945 15.6072 15.6992 15.3341 16.4092L13.7576 20.5082C13.6226 20.8592 13.2852 21.0909 12.9091 21.0909C12.5329 21.0909 12.1956 20.8592 12.0606 20.5082L10.4841 16.4092C10.211 15.6992 10.1252 15.4945 10.0078 15.3295C9.88999 15.1638 9.74527 15.0191 9.57963 14.9013C9.41455 14.7839 9.20994 14.6981 8.4999 14.425L4.40093 12.8485C4.04984 12.7135 3.81818 12.3762 3.81818 12C3.81818 11.6238 4.04984 11.2865 4.40093 11.1515L8.49989 9.57498C9.20994 9.30189 9.41454 9.21607 9.57963 9.09869C9.74527 8.9809 9.89 8.83618 10.0078 8.67054C10.1252 8.50545 10.211 8.30084 10.4841 7.5908L12.0606 3.49184C12.1956 3.14075 12.5329 2.90909 12.9091 2.90909ZM12.9091 6.35062L12.1811 8.24349C12.169 8.27483 12.1571 8.30576 12.1454 8.3363C11.924 8.9129 11.7567 9.34846 11.4896 9.72416C11.254 10.0555 10.9645 10.3449 10.6333 10.5805C10.2575 10.8476 9.82199 11.0149 9.24539 11.2363C9.21486 11.248 9.18392 11.2599 9.15258 11.272L7.25971 12L9.15258 12.728C9.18392 12.7401 9.21486 12.752 9.24539 12.7637C9.82199 12.9851 10.2575 13.1524 10.6333 13.4195C10.9645 13.6551 11.254 13.9445 11.4896 14.2758C11.7567 14.6515 11.924 15.0871 12.1454 15.6637C12.1571 15.6942 12.169 15.7252 12.1811 15.7565L12.9091 17.6494L13.6371 15.7565C13.6492 15.7252 13.6611 15.6942 13.6728 15.6637C13.8942 15.0871 14.0615 14.6515 14.3286 14.2758C14.5642 13.9446 14.8536 13.6551 15.1849 13.4195C15.5606 13.1524 15.9962 12.9851 16.5728 12.7637C16.6033 12.752 16.6343 12.7401 16.6656 12.728L18.5585 12L16.6656 11.272C16.6343 11.2599 16.6033 11.248 16.5728 11.2363C15.9962 11.0149 15.5606 10.8476 15.1849 10.5805C14.8536 10.3449 14.5642 10.0555 14.3286 9.72416C14.0615 9.34846 13.8942 8.9129 13.6728 8.3363C13.6611 8.30577 13.6492 8.27483 13.6371 8.24349L12.9091 6.35062ZM5.18182 15.6364C5.6839 15.6364 6.09091 16.0434 6.09091 16.5455V17.9091H7.45455C7.95662 17.9091 8.36364 18.3161 8.36364 18.8182C8.36364 19.3203 7.95662 19.7273 7.45455 19.7273H6.09091V21.0909C6.09091 21.593 5.6839 22 5.18182 22C4.67974 22 4.27273 21.593 4.27273 21.0909V19.7273H2.90909C2.40701 19.7273 2 19.3203 2 18.8182C2 18.3161 2.40701 17.9091 2.90909 17.9091H4.27273V16.5455C4.27273 16.0434 4.67974 15.6364 5.18182 15.6364Z",fill:"currentColor"})}),md=n=>n?n==="utility-1"?l.jsx(Tr,{}):n==="utility-2"?l.jsx(nd,{}):n==="utility-3"?l.jsx(rd,{}):n==="utility-4"?l.jsx(pd,{}):n==="utility-5"?l.jsx(id,{}):n==="utility-6"?l.jsx(Sr,{}):n==="utility-7"?l.jsx(sn,{}):n==="utility-8"?l.jsx(od,{}):n==="utility-9"?l.jsx(hd,{}):n==="utility-10"?l.jsx(Xn,{}):n==="media-1"?l.jsx(cd,{}):n==="media-2"?l.jsx(ad,{}):n==="media-3"?l.jsx(fd,{}):n==="media-4"?l.jsx(sd,{}):n==="media-5"?l.jsx(xn,{}):n==="media-6"?l.jsx(vn,{}):n==="media-7"?l.jsx(ud,{}):n==="media-8"?l.jsx(dd,{}):n==="media-9"?l.jsx(ld,{}):n==="media-10"?l.jsx(Qn,{}):n==="other-1"?l.jsx(es,{}):n==="other-2"?l.jsx(Jn,{}):n==="other-3"?l.jsx(wn,{}):n==="other-4"?l.jsx(gd,{}):n==="other-5"?l.jsx(Nr,{}):n==="default-icon"?l.jsx(wn,{}):(console.warn("Icon ID not found:",n),l.jsx(sn,{})):l.jsx(sn,{});function _d(){const{user:n,logOut:e}=Kt(),t=En(),[s,i]=x.useState([]),[r,o]=x.useState(!1),[a,c]=x.useState(null),[d,h]=x.useState(""),[u,f]=x.useState(!1),[m,_]=x.useState({}),[v,C]=x.useState(!1),[k,F]=x.useState({}),[Q,z]=x.useState(!1),[ae,ge]=x.useState(""),[Re,je]=x.useState(!1);x.useEffect(()=>{n&&ce()},[n]),x.useEffect(()=>{s.length>0&&(ee(),me())},[s]);const ce=async()=>{if(n)try{o(!0),c(null);const y=await dc(n.uid);i(y)}catch(y){console.error("Failed to load holes:",y),c("Failed to load your holes. Please try again.")}finally{o(!1)}},ee=async()=>{if(s.length!==0)try{C(!0);const y={},te=s.map(async O=>{try{const ue=(await yn(O.id)).reduce((Ve,g)=>Ve+(g.totalDuration||0),0);y[O.id]=ue}catch(he){console.error(`Failed to load sessions for hole ${O.id}:`,he),y[O.id]=0}});await Promise.all(te),_(y)}catch(y){console.error("Failed to load session times:",y)}finally{C(!1)}},me=async()=>{if(s.length!==0)try{z(!0);const y={},te=s.map(async O=>{try{const he=await yn(O.id);let ue=0;const Ve=he.map(async b=>{try{return(await mr(b.id,999)).entries.length}catch(j){return console.error(`Failed to load entries for session ${b.id}:`,j),0}});ue=(await Promise.all(Ve)).reduce((b,j)=>b+j,0),y[O.id]=ue}catch(he){console.error(`Failed to load insight counts for hole ${O.id}:`,he),y[O.id]=0}});await Promise.all(te),F(y)}catch(y){console.error("Failed to load insight counts:",y)}finally{z(!1)}},T=async()=>{if(!(!n||!d.trim()))try{f(!0),c(null),await ac(n.uid,d,"default-icon"),h(""),await ce()}catch(y){console.error("Failed to create hole:",y),c("Failed to create a new hole. Please try again.")}finally{f(!1)}},Ae=y=>{t(`/holes/${y}/insights`)},_e=y=>{if(!y)return"";const te=y.toDate();return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(te).replace(/\//g,".")},Be=y=>{const te=Math.floor(y/3600),O=Math.floor(y%3600/60),he=Math.floor(y%60);return`${te}h ${O}m ${he}s`},de=s.filter(y=>y.name.toLowerCase().includes(ae.toLowerCase())),Ge=async()=>{d.trim()&&(await T(),je(!1))},ye=()=>{h(""),je(!1)};return l.jsxs("div",{className:"w-full min-h-screen flex flex-col",children:[l.jsx("div",{"data-size":"lg",className:"fixed top-0 left-0 right-0 z-50 w-full h-16 px-4 sm:px-6 bg-white border-b border-gray-200 flex flex-col justify-start items-center gap-2.5",children:l.jsxs("div",{className:"w-full py-3 inline-flex justify-between items-center",children:[l.jsx("div",{className:"text-center justify-center text-text-primary-light text-title-md leading-normal",children:"Diggin"}),l.jsx("div",{children:l.jsx(xe,{variant:"primary",size:"md",onClick:()=>{try{e()}catch(y){console.error("Logout failed:",y)}},children:"Log out"})})]})}),l.jsx("div",{className:"flex-1 w-full min-h-screen pt-16 px-4 sm:px-6 lg:px-24 bg-white",children:l.jsx("div",{className:"py-10 flex flex-col justify-start items-center gap-14 min-h-[calc(100vh-64px)] overflow-y-auto",children:l.jsxs("div",{className:"w-full max-w-[1520px] flex flex-col justify-start items-start gap-5",children:[l.jsxs("div",{className:"w-full h-auto flex flex-col sm:flex-row sm:h-10 justify-between items-start sm:items-center gap-4 sm:gap-0",children:[l.jsx("div",{className:"justify-center text-gray-950 text-lg font-medium font-['Pretendard'] leading-normal",children:"Holes"}),l.jsxs("div",{className:"flex justify-start items-center gap-2 w-full sm:w-auto",children:[l.jsxs("div",{"data-status":"open",className:"flex-1 sm:w-80 flex justify-start items-center gap-2",children:[l.jsx("div",{"data-size":"md","data-status":"default",className:"flex-1 h-10 rounded-lg flex justify-start items-center gap-2.5",children:l.jsx(Ft,{size:"md",placeholder:"Search",value:ae,onChange:y=>ge(y.target.value),isDisabled:!1,error:!1,className:"flex-1"})}),l.jsx("div",{className:"rounded flex justify-start items-center gap-2",children:l.jsx("div",{className:"w-9 h-9 flex justify-center items-center gap-2.5",children:l.jsx("div",{className:"w-5 h-5 relative overflow-hidden text-gray-950",children:l.jsx(Tr,{})})})})]}),l.jsx("div",{"data-status":"default",className:"flex justify-start items-center",children:l.jsx("div",{className:"rounded flex justify-start items-center gap-2",children:l.jsx("div",{className:"w-9 h-9 flex justify-center items-center gap-2.5 cursor-pointer hover:bg-gray-100 rounded",children:l.jsx("div",{className:"w-5 h-5 relative text-gray-950",children:l.jsx(Xn,{})})})})})]})]}),a&&l.jsx("div",{className:"w-full text-red-500 mb-4",children:a}),r&&s.length===0?l.jsx("div",{className:"py-10 flex justify-center items-center",children:l.jsx("div",{className:"text-gray-700",children:"Loading..."})}):de.length===0&&ae?l.jsx("div",{className:"py-20 flex flex-col justify-center items-center gap-5",children:l.jsx("div",{className:"text-center text-neutral-700 text-lg font-medium font-['Pretendard']",children:"No holes found"})}):de.length===0?l.jsxs("div",{className:"w-full flex flex-col justify-center items-center py-20",children:[l.jsx("div",{className:"w-32 h-32 sm:w-40 sm:h-40 bg-gray-200 rounded-full mb-5"}),l.jsx("div",{className:"text-center text-text-secondary-light text-title-md",children:"No hole yet"})]}):l.jsxs("div",{className:"w-full flex flex-col justify-start items-center",children:[l.jsxs("div",{"data-property-1":"top",className:"w-full h-14 pl-4 pr-4 py-3 border-b border-gray-200 inline-flex justify-between items-center",children:[l.jsx("div",{className:"flex justify-start items-center gap-4",children:l.jsx("div",{className:"justify-center text-gray-700 text-sm font-medium font-['Pretendard'] leading-none",children:"Name"})}),l.jsxs("div",{className:"pr-4 sm:pr-12 flex justify-start items-center gap-6",children:[l.jsxs("div",{className:"hidden sm:flex w-36 lg:w-36 justify-start items-center gap-1",children:[l.jsx("div",{className:"w-4 h-4 relative text-gray-700",children:l.jsx(es,{})}),l.jsx("div",{className:"justify-center text-gray-700 text-sm font-medium font-['Pretendard'] leading-none",children:"Modified"})]}),l.jsxs("div",{className:"w-20 flex justify-start items-center gap-1",children:[l.jsx("div",{className:"w-4 h-4 relative overflow-hidden text-gray-700",children:l.jsx(Jn,{})}),l.jsx("div",{className:"justify-center text-gray-700 text-sm font-medium font-['Pretendard'] leading-none",children:"Time"})]})]})]}),l.jsx("div",{className:"w-full flex flex-col justify-start items-start",children:de.map(y=>l.jsxs("div",{"data-property-1":"default",className:"w-full pl-4 pr-3 py-3 border-b border-gray-200 inline-flex justify-between items-center cursor-pointer hover:bg-gray-50",onClick:()=>Ae(y.id),children:[l.jsxs("div",{className:"flex justify-start items-center gap-4 flex-1 min-w-0",children:[l.jsx("div",{className:"w-5 h-5 relative overflow-hidden text-gray-950 flex-shrink-0",children:md(y.icon)}),l.jsx("div",{className:"justify-center text-text-primary-light text-body-lg-rg leading-snug truncate",children:y.name}),l.jsx("div",{className:"justify-center text-text-tertiary-light text-body-lg-rg text-base leading-snug flex-shrink-0",children:Q?l.jsx("span",{children:"..."}):k[y.id]||0})]}),l.jsxs("div",{className:"flex justify-start items-center gap-6",children:[l.jsx("div",{className:"hidden sm:block w-36 lg:w-36 justify-center text-text-secondary-light text-body-md-rg leading-none",children:_e(y.updatedAt)}),l.jsx("div",{className:"w-20 justify-center text-text-secondary-light text-body-md-rg leading-none",children:v?l.jsx("span",{children:"..."}):Be(m[y.id]||0)}),l.jsx("div",{className:"rounded flex justify-start items-center gap-2",children:l.jsx("div",{className:"w-7 h-7 flex justify-center items-center gap-2.5",children:l.jsx("div",{className:"w-4 h-4 relative overflow-hidden text-gray-950",children:l.jsx(Qn,{})})})})]})]},y.id))})]}),Re&&l.jsx("div",{className:"w-full bg-white border border-gray-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Ft,{size:"md",placeholder:"Enter hole name",value:d,onChange:y=>h(y.target.value),isDisabled:u,error:!1,className:"flex-1"}),l.jsx(xe,{variant:"primary",size:"md",onClick:Ge,disabled:u||!d.trim(),children:u?"Creating...":"Create"}),l.jsx(xe,{variant:"secondary",size:"md",onClick:ye,disabled:u,children:"Cancel"})]})})]})})})]})}const bn="highlights";async function ts(n,e){try{const t=yt(Ie(le,bn),Pe("userId","==",n),Pe("holeId","==",e)),s=await Ct(t);return s.empty?[]:s.docs[0].data().textEntryIds||[]}catch(t){throw console.error("Error getting highlights:",t),new Error("Failed to get highlights")}}async function Ir(n,e,t){try{const s=yt(Ie(le,bn),Pe("userId","==",n),Pe("holeId","==",e)),i=await Ct(s);if(i.empty){const r=Ut(Ie(le,bn)),o={userId:n,holeId:e,textEntryIds:t,createdAt:Ke(),updatedAt:Ke()};await Xs(r,o)}else{const r=i.docs[0];await ao(r.ref,{textEntryIds:t,updatedAt:Ke()})}}catch(s){throw console.error("Error saving highlights:",s),new Error("Failed to save highlights")}}async function yd(n,e,t){try{const s=await ts(n,e);if(!s.includes(t)){const i=[...s,t];await Ir(n,e,i)}}catch(s){throw console.error("Error adding to highlights:",s),new Error("Failed to add to highlights")}}async function zs(n,e,t){try{const i=(await ts(n,e)).filter(r=>r!==t);await Ir(n,e,i)}catch(s){throw console.error("Error removing from highlights:",s),new Error("Failed to remove from highlights")}}function Cd(){var Ve;const{holeId:n}=Rr(),{user:e,logOut:t}=Kt(),s=En(),[i,r]=x.useState(null),[o,a]=x.useState([]),[c,d]=x.useState("all"),[h,u]=x.useState([]),[f,m]=x.useState(!0),[_,v]=x.useState(null),[C,k]=x.useState([]),[F,Q]=x.useState(!1),[z,ae]=x.useState(""),[ge,Re]=x.useState(!0),[je,ce]=x.useState(!1),[ee,me]=x.useState(null);x.useEffect(()=>{(async()=>{if(!(!e||!n))try{m(!0);const b=await cc(n);r(b);const j=await yn(n);a(j),await T(j.map(H=>H.id));const A=await ts(e.uid,n);k(A)}catch(b){console.error("Failed to load hole data:",b),v("Failed to load data")}finally{m(!1)}})()},[e,n]);const T=async g=>{if(g.length===0){u([]);return}try{m(!0),v(null);let b=[];for(const j of g){const{entries:A}=await mr(j,100);b=[...b,...A]}b.sort((j,A)=>{var Le,Z,G,ns;const H=((Z=(Le=j.capturedAt)==null?void 0:Le.toDate)==null?void 0:Z.call(Le))||new Date(0);return(((ns=(G=A.capturedAt)==null?void 0:G.toDate)==null?void 0:ns.call(G))||new Date(0)).getTime()-H.getTime()}),u(b)}catch(b){console.error("Failed to load entries:",b),v("Failed to load insights. Please try again.")}finally{m(!1)}},Ae=x.useCallback(async()=>{var g,b,j;if(console.log(" [DEBUG] Starting to process pending items..."),!((b=(g=window.chrome)==null?void 0:g.runtime)!=null&&b.sendMessage)){console.log(" [DEBUG] Chrome extension API not available");return}console.log(" [DEBUG] Chrome extension API is available");try{console.log(" [DEBUG] Sending GET_PENDING_ITEMS message to background");const A=await new Promise(Z=>{window.chrome.runtime.sendMessage({action:"GET_PENDING_ITEMS"},G=>{console.log(" [DEBUG] Received response from background:",G),Z(G)})});if(!(A!=null&&A.success)){console.log(" [DEBUG] Response not successful:",A);return}if(!A.pendingItems){console.log(" [DEBUG] No pendingItems in response");return}if(!A.pendingItems.length){console.log(" [DEBUG] pendingItems array is empty");return}console.log(` [DEBUG] Found ${A.pendingItems.length} pending items to process`),console.log(" [DEBUG] Pending items:",A.pendingItems);let H=0,fe=0;const Le=c!=="all"?c:((j=o[0])==null?void 0:j.id)||"default";console.log(` [DEBUG] Target session ID: ${Le}`);for(const Z of A.pendingItems)try{console.log(` [DEBUG] Processing item: ${Z.content.substring(0,50)}...`),console.log(` [DEBUG] Item URL: ${Z.url||"No URL"}`),await hc(Le,Z.content,Z.url||""),H++,console.log(` [DEBUG] Successfully processed item: ${Z.content.substring(0,30)}...`)}catch(G){fe++,console.error(` [DEBUG] Failed to process item: ${Z.content.substring(0,30)}...`,G)}console.log(` [DEBUG] Processing complete: ${H} success, ${fe} failed`),fe===0&&(console.log(" [DEBUG] Clearing pending items from storage..."),await new Promise(Z=>{window.chrome.runtime.sendMessage({action:"CLEAR_PENDING_ITEMS"},G=>{console.log(" [DEBUG] Clear response:",G),G!=null&&G.success?console.log(" [DEBUG] Pending items cleared from storage"):console.error(" [DEBUG] Failed to clear pending items:",G==null?void 0:G.error),Z()})}),o.length>0&&(console.log(" [DEBUG] Reloading entries..."),c==="all"?await T(o.map(Z=>Z.id)):await T([c]),console.log(" [DEBUG] Entries reloaded")))}catch(A){console.error(" [DEBUG] Error processing pending items:",A)}},[e,c,o,T]);x.useEffect(()=>{console.log(" [DEBUG] useEffect for processPendingItems triggered"),console.log(" [DEBUG] Conditions - user:",!!e,"sessions.length:",o.length,"loading:",f),e&&o.length>0&&!f?(console.log(" [DEBUG] All conditions met, calling processPendingItems"),Ae()):console.log(" [DEBUG] Conditions not met for processPendingItems")},[e,o,f,Ae]);const _e=async g=>{if(!(!e||!n))try{C.includes(g)?(await zs(e.uid,n,g),k(C.filter(b=>b!==g))):(await yd(e.uid,n,g),k([...C,g]))}catch(b){console.error("Failed to update highlights:",b)}},Be=g=>{if(!g)return"";const b=g.toDate?g.toDate():new Date(g);return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(b).replace(/\//g,".")},de=g=>{if(!g)return"";const b=g.toDate?g.toDate():new Date(g);return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(b).replace(/\//g,".")},Ge=()=>{const g=o.reduce((H,fe)=>H+(fe.totalDuration||0),0),b=Math.floor(g/3600),j=Math.floor(g%3600/60),A=Math.floor(g%60);return`${b}:${j.toString().padStart(2,"0")}:${A.toString().padStart(2,"0")}`},ye=g=>{try{return new URL(g).hostname.replace("www.","")}catch{return g}},y=()=>{const g=h.filter(j=>j.content.toLowerCase().includes(z.toLowerCase())||j.sourceUrl&&ye(j.sourceUrl).toLowerCase().includes(z.toLowerCase())),b={};return g.forEach(j=>{const A=j.sourceUrl||"Unknown Source";b[A]||(b[A]=[]),b[A].push(j)}),b},te=g=>{me(g),ce(!0)},O=async()=>{if(ee)try{await fc(ee),u(h.filter(g=>g.id!==ee)),C.includes(ee)&&(await zs(e.uid,n,ee),k(C.filter(g=>g!==ee))),ce(!1),me(null)}catch(g){console.error("Failed to delete entry:",g)}},he=()=>{ce(!1),me(null)};if(f&&!i)return l.jsx("div",{className:"w-full h-screen flex flex-col",children:l.jsx("div",{className:"flex-1 flex justify-center items-center",children:l.jsx("div",{className:"text-gray-700",children:"Loading..."})})});if(_)return l.jsx("div",{className:"w-full min-h-screen flex flex-col",children:l.jsx("div",{className:"flex-1 flex justify-center items-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-red-500 text-lg font-medium",children:_}),l.jsx(xe,{variant:"primary",size:"md",onClick:()=>s("/holes"),className:"mt-4",children:"Back to Holes"})]})})});const ue=y();return l.jsxs("div",{className:"w-full h-screen bg-white flex flex-col overflow-hidden",children:[l.jsx("div",{className:"w-full px-4 sm:px-6 bg-white border-b border-gray-200 flex flex-col justify-start items-center gap-2.5",children:l.jsxs("div",{className:"w-full py-3 inline-flex justify-between items-center",children:[l.jsx("div",{className:"flex justify-start items-center gap-2.5",children:l.jsx("div",{className:"rounded flex justify-start items-center gap-2",children:l.jsx("div",{className:"w-9 h-9 flex justify-center items-center gap-2.5 cursor-pointer hover:bg-gray-100 rounded",onClick:()=>s("/holes"),children:l.jsx("div",{className:"w-5 h-5 relative overflow-hidden",children:l.jsx(Nr,{})})})})}),l.jsxs("div",{className:"hidden md:flex justify-start items-center gap-4 lg:gap-6",children:[l.jsxs("div",{className:"flex justify-start items-center gap-4",children:[l.jsx("div",{className:"w-6 h-6 relative overflow-hidden",children:l.jsx(wn,{})}),l.jsxs("div",{className:"flex justify-start items-center gap-2",children:[l.jsx("div",{className:"text-center justify-center text-text-primary-light text-title-md leading-normal truncate max-w-32 lg:max-w-52",children:i==null?void 0:i.name}),l.jsx("div",{className:"justify-center text-text-secondary-light text-body-lg-rg leading-snug",children:h.length})]})]}),l.jsxs("div",{className:"hidden lg:flex justify-start items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 relative",children:l.jsx(Jn,{})}),l.jsx("div",{className:"justify-center text-text-tertiary-light text-body-lg-rg leading-snug",children:Ge()})]}),l.jsxs("div",{className:"hidden lg:flex justify-start items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 relative",children:l.jsx(es,{})}),l.jsx("div",{className:"justify-center text-text-tertiary-light text-body-lg-rg leading-snug",children:i!=null&&i.updatedAt?de(i.updatedAt):""})]})]}),l.jsx("div",{className:"md:hidden flex-1 text-center",children:l.jsx("div",{className:"text-text-primary-light text-title-md leading-normal truncate",children:i==null?void 0:i.name})}),l.jsx("div",{className:"flex justify-start items-center gap-4",children:l.jsx(xe,{variant:"primary",size:"md",onClick:()=>{try{t()}catch(g){console.error("Logout failed:",g)}},className:"text-sm sm:text-base",children:"Log out"})})]})}),l.jsx("div",{className:"flex-1 w-full h-full max-h-[calc(100vh-90px)] px-4 sm:px-6 lg:px-24 lg:py-10 flex flex-col justify-start items-center gap-2.5 overflow-hidden",children:l.jsxs("div",{className:"w-full flex-1 max-w-[1520px] h-[calc(100vh-160px)] pt-6 flex flex-col xl:flex-row justify-center items-start gap-6 xl:gap-10 transition-all duration-300 ease-in-out",children:[l.jsxs("div",{className:`w-full h-full flex flex-col justify-start items-start gap-5 overflow-hidden transition-all duration-300 ease-in-out ${ge?"flex-1 max-w-[1280px]":"max-w-[1000px] mx-auto"}`,children:[l.jsxs("div",{className:"w-full h-auto flex flex-col sm:flex-row sm:h-10 justify-between items-start sm:items-center gap-4 sm:gap-0",children:[l.jsxs("div",{className:"flex justify-start items-center gap-2",children:[l.jsx("div",{className:"justify-center text-text-primary-light text-title-md leading-normal",children:"Insights in"}),l.jsxs("div",{className:"h-9 px-3 rounded-lg flex justify-start items-center gap-3",children:[l.jsx("div",{className:"justify-center text-text-primary-light text-title-md leading-normal",children:c==="all"?"All":((Ve=o.find(g=>g.id===c))==null?void 0:Ve.name)||"Session"}),l.jsx("div",{className:"w-2 h-2 relative overflow-hidden",children:l.jsx(Qn,{})})]})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row justify-end items-start sm:items-center gap-4 w-full sm:w-auto",children:[l.jsxs("div",{className:"flex justify-end items-center gap-2 w-full sm:max-w-96",children:[l.jsx("div",{className:"flex-1 sm:max-w-80 flex justify-end items-center gap-2",children:l.jsx(Ft,{size:"md",placeholder:"Search insights...",value:z,onChange:g=>ae(g.target.value),isDisabled:!1,error:!1,className:"flex-1"})}),l.jsx("div",{className:"rounded flex justify-start items-center gap-2",children:l.jsx("div",{className:"w-9 h-9 flex justify-center items-center gap-2.5 cursor-pointer hover:bg-gray-100 rounded",children:l.jsx("div",{className:"w-5 h-5 relative",children:l.jsx(Xn,{})})})})]}),l.jsxs("div",{className:"p-0.5 flex justify-start items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 flex justify-center items-center gap-2.5",children:l.jsx("input",{type:"checkbox",checked:F,onChange:g=>Q(g.target.checked),className:"w-4 h-4 rounded-sm border border-gray-300"})}),l.jsx("div",{className:"justify-start w-[90px] text-text-primary-light text-body-md-rg leading-none",children:"Hide page info"})]})]})]}),l.jsxs("div",{className:"w-full flex-1 h-full flex flex-col justify-start items-start gap-6 sm:gap-10 overflow-y-auto pr-3.5",children:[f&&l.jsx("div",{className:"w-full flex justify-center items-center py-20",children:l.jsx("div",{className:"text-gray-700",children:"Loading insights..."})}),!f&&h.length===0&&l.jsxs("div",{className:"w-full flex flex-col justify-center items-center py-20",children:[l.jsx("div",{className:"w-32 h-32 sm:w-40 sm:h-40 bg-gray-200 rounded-full mb-5"}),l.jsx("div",{className:"text-center text-text-secondary-light text-title-md",children:"No insights yet"})]}),!f&&Object.keys(ue).map((g,b)=>{var j,A;return l.jsxs("div",{className:"w-full flex flex-col justify-start items-start gap-5",children:[!F&&l.jsx("div",{className:"flex flex-col justify-start items-start gap-2",children:l.jsxs("div",{className:"flex justify-start items-center gap-3 sm:gap-4",children:[l.jsx("img",{className:"w-10 h-10 sm:w-10 sm:h-10 rounded border border-gray-200 flex-shrink-0 object-cover",src:`https://api.urlbox.io/v1/qyfxZOkLVtHTYZlw/png?url=${encodeURIComponent(g)}&width=320&height=160&delay=1000`,alt:"Site thumbnail",onError:H=>{H.target.src=`https://www.google.com/s2/favicons?domain=${ye(g)}&sz=64`}}),l.jsxs("div",{className:"flex-1 min-w-0 inline-flex flex-col justify-start items-start gap-0.5",children:[l.jsx("div",{className:"justify-center text-text-primary-light text-body-lg-rg leading-snug truncate w-full",children:ye(g)}),l.jsxs("div",{className:"inline-flex justify-start items-start gap-1 text-text-tertiary-light text-body-sm-rg",children:[l.jsx("div",{className:"leading-none",children:(j=ue[g][0])!=null&&j.capturedAt?Be(ue[g][0].capturedAt):""}),l.jsx("div",{className:"text-center leading-none",children:""}),l.jsx("div",{className:"leading-none truncate",children:((A=o.find(H=>ue[g].some(fe=>fe.sessionId===H.id)))==null?void 0:A.name)||"Session"})]})]})]})}),l.jsx("div",{className:"w-full flex flex-col justify-start items-start gap-3 sm:gap-5",children:ue[g].map(H=>l.jsxs("div",{className:`group relative w-full pl-3 sm:pl-4 pr-3 sm:pr-5 py-2 sm:py-1 border-l-2 border-line-tertiary inline-flex justify-start items-start gap-2.5 cursor-pointer hover:border-gray-400 transition-colors ${C.includes(H.id)?"border-line-tertia bg-fill-hover-secondary-light":""}`,onClick:()=>_e(H.id),children:[l.jsx("div",{className:"flex-1 justify-center text-text-primary-light text-body-lg-rg leading-snug",children:H.content}),l.jsx("button",{onClick:fe=>{fe.stopPropagation(),te(H.id)},className:"absolute bottom-0 right-0 w-5 h-5 hover:bg-gray-100 flex justify-center items-center opacity-0 group-hover:opacity-100 transition-opacity",children:l.jsx("div",{className:"w-3 h-3 relative overflow-hidden",children:l.jsx(Sr,{})})})]},H.id))})]},g)})]})]}),l.jsx("div",{className:`w-full h-full xl:w-96 flex justify-center items-start gap-2.5 transition-all duration-500 ease-in-out ${ge?"transform translate-x-0 opacity-100":"transform translate-x-full opacity-0 pointer-events-none xl:absolute xl:right-0"}`,children:l.jsxs("div",{className:"flex-1 h-full xl:self-stretch p-4 sm:p-5 bg-gray-25 rounded-2xl inline-flex flex-col justify-start items-start gap-5",children:[l.jsxs("div",{className:"w-full h-12 pr-0.5 rounded-lg inline-flex justify-between items-center overflow-hidden",children:[l.jsxs("div",{className:"flex justify-start items-center gap-2",children:[l.jsx("div",{className:"w-[20px] h-[20px] relative",children:l.jsx(vn,{})}),l.jsx("div",{className:"justify-center text-text-primary-light text-title-md leading-normal",children:"Highlights"})]}),l.jsx("div",{className:"rounded flex justify-start items-center gap-2",children:l.jsx(xe,{variant:"tertiary",size:"md",isIconOnly:!0,leftIcon:l.jsx(xn,{}),showLeftIcon:!0,onClick:()=>Re(!ge),children:l.jsx(xn,{})})})]}),l.jsxs("div",{className:"w-full flex-1 inline-flex justify-start items-start gap-1 overflow-hidden",children:[l.jsx("div",{className:"flex-1 inline-flex flex-col items-center gap-3 overflow-y-auto h-full max-h-full pr-3.5",children:C.length===0?l.jsxs("div",{className:"w-full pl-4 text-center text-text-secondary-light text-body-lg-rg",children:["Click on insights ",l.jsx("br",{})," to add them to highlights"]}):h.filter(g=>C.includes(g.id)).map(g=>l.jsx("div",{className:"w-full pl-2 py-1 inline-flex justify-center items-center gap-2.5 cursor-pointer hover:bg-gray-100 rounded transition-colors",onClick:()=>_e(g.id),children:l.jsx("div",{className:"flex-1 justify-center text-text-primary-light text-body-lg-rg leading-snug",children:g.content})},g.id))}),l.jsx("div",{className:"hidden xl:block h-72 p-1 flex justify-start items-center gap-2.5",children:l.jsx("div",{className:"w-1 self-stretch bg-gray-200 rounded"})})]})]})})]})}),l.jsx("div",{className:`fixed right-0 top-[120px] z-10 transition-all duration-500 ease-in-out ${ge?"transform translate-x-full opacity-0 pointer-events-none":"transform translate-x-0 opacity-100"}`,children:l.jsx("button",{onClick:()=>Re(!0),className:"w-12 h-12 bg-white border-l border-t border-b border-gray-200 rounded-tl-2xl rounded-bl-2xl flex justify-center items-center hover:bg-gray-50 transition-colors shadow-sm",children:l.jsx("div",{className:"w-5 h-5 relative",children:l.jsx(vn,{})})})}),je&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:l.jsxs("div",{className:"w-96 px-6 py-9 bg-white rounded-2xl border-t border-gray-200 flex flex-col justify-center items-center gap-6",children:[l.jsxs("div",{className:"w-full flex flex-col justify-start items-center gap-3",children:[l.jsx("div",{className:"w-full text-center text-gray-950 text-lg font-medium leading-normal",children:"Delete the Insight?"}),l.jsxs("div",{className:"w-full text-center text-gray-500 text-sm font-medium leading-none",children:["You will not be able to recover it,",l.jsx("br",{}),"but you can highlight more valuable insights."]})]}),l.jsxs("div",{className:"flex justify-end items-center gap-3",children:[l.jsx(xe,{variant:"secondary",size:"md",onClick:he,children:"Cancel"}),l.jsx(xe,{variant:"primary",size:"md",onClick:O,className:"bg-red-500 hover:bg-red-600 text-white",children:"Delete"})]})]})})]})}function qs({children:n}){const{user:e}=Kt(),t=$s();return e?l.jsx(l.Fragment,{children:n}):l.jsx(Ks,{to:"/login",state:{from:t},replace:!0})}function xd(){const[n,e]=x.useState(!0);return x.useEffect(()=>{const t=Js($t,()=>{e(!1)});return()=>t()},[]),n?l.jsx("div",{className:"min-h-screen flex items-center justify-center bg-color-surface-bg",children:l.jsx("div",{className:"text-center",children:l.jsx("div",{className:"text-color-text-primary text-xl font-medium",children:"Loading..."})})}):l.jsx(oc,{children:l.jsx(jr,{children:l.jsxs(Ar,{children:[l.jsx(Nt,{path:"/",element:l.jsx(Ks,{to:"/login",replace:!0})}),l.jsx(Nt,{path:"/login",element:l.jsx(lc,{})}),l.jsx(Nt,{path:"/holes",element:l.jsx(qs,{children:l.jsx(_d,{})})}),l.jsx(Nt,{path:"/holes/:holeId/insights",element:l.jsx(qs,{children:l.jsx(Cd,{})})})]})})})}rn.createRoot(document.getElementById("root")).render(l.jsx(Nn.StrictMode,{children:l.jsx(xd,{})}));
